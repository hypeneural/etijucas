import{j as e,m as x,r as v,l as S,w as se,o as ie,bx as re}from"./vendor-app-B8nTTOoa.js";import{I as o}from"./iconify-D28nYmSY.js";import{c as d,u as ne,B as G}from"./index-BAqHRbEy.js";import{C as w}from"./card-CLwiJjf5.js";import{S as M}from"./skeleton-XkZreYS5.js";import{T as oe,a as de,b as q,c as R}from"./tabs-CketOlr7.js";import{u as le,a as ce,b as W,f as Q,c as K}from"./weather.service-oem64CSp.js";import{h as A}from"./useHaptic-D9J3ZOOx.js";import{p as me}from"./pt-BR-Cy3ubUx4.js";const xe={success:{bg:"bg-emerald-50 dark:bg-emerald-900/20",border:"border-emerald-200 dark:border-emerald-700",text:"text-emerald-700 dark:text-emerald-300",iconBg:"bg-emerald-100 dark:bg-emerald-800"},info:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-700",text:"text-blue-700 dark:text-blue-300",iconBg:"bg-blue-100 dark:bg-blue-800"},warning:{bg:"bg-amber-50 dark:bg-amber-900/20",border:"border-amber-200 dark:border-amber-700",text:"text-amber-700 dark:text-amber-300",iconBg:"bg-amber-100 dark:bg-amber-800"},danger:{bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-200 dark:border-red-700",text:"text-red-700 dark:text-red-300",iconBg:"bg-red-100 dark:bg-red-800"}},he={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.08}}},ue={hidden:{opacity:0,y:20,scale:.95},show:{opacity:1,y:0,scale:1}};function Y({insights:t,className:a}){return t.length?e.jsx(x.div,{variants:he,initial:"hidden",animate:"show",className:d("space-y-3",a),children:t.map((s,i)=>e.jsx(pe,{insight:s},`${s.type}-${i}`))}):e.jsxs("div",{className:d("text-center py-8 text-muted-foreground",a),children:[e.jsx(o,{icon:"mdi:weather-sunny",className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Nenhum insight dispon√≠vel"})]})}function pe({insight:t}){const a=xe[t.severity];return e.jsx(x.div,{variants:ue,children:e.jsx(w,{className:d("p-4 border-l-4 transition-all duration-200 hover:shadow-md",a.bg,a.border),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:d("flex-shrink-0 p-2 rounded-full",a.iconBg),children:e.jsx(o,{icon:t.icon,className:d("h-5 w-5",a.text)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:d("font-semibold text-sm",a.text),children:t.title}),t.badge&&e.jsx("span",{className:d("text-xs px-2 py-0.5 rounded-full font-medium",a.iconBg,a.text),children:t.badge})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.message}),t.detail&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.detail})]}),t.meta?.score!==void 0&&e.jsxs("div",{className:"flex-shrink-0 text-center",children:[e.jsx("div",{className:d("text-2xl font-bold",t.meta.score>=7?"text-emerald-500":t.meta.score>=5?"text-amber-500":"text-red-500"),children:t.meta.score}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"/10"})]})]})})})}function ge({insight:t}){const a=t.meta?.score??0,s=t.meta?.positives??[],i=t.meta?.negatives??[],r=a>=7?"from-emerald-400 to-emerald-600":a>=5?"from-amber-400 to-amber-600":"from-red-400 to-red-600";return e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs(w,{className:"overflow-hidden",children:[e.jsx("div",{className:d("bg-gradient-to-r p-6 text-white",r),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(o,{icon:"mdi:beach",className:"h-6 w-6"}),"D√° praia?"]}),e.jsx("p",{className:"text-white/90 mt-1",children:t.message})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl font-bold",children:a}),e.jsx("div",{className:"text-sm text-white/80",children:"/10"})]})]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[s.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-emerald-600 dark:text-emerald-400 mb-1",children:"‚úì Pontos positivos"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.map((n,m)=>e.jsx("span",{className:"text-xs bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300 px-2 py-1 rounded-full",children:n},m))})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-red-600 dark:text-red-400 mb-1",children:"‚úó Aten√ß√£o"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.map((n,m)=>e.jsx("span",{className:"text-xs bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300 px-2 py-1 rounded-full",children:n},m))})]})]})]})})}function fe({condition:t,waveHeight:a,period:s}){const i={calm:{emoji:"‚úÖ",label:"Mar Calmo",bg:"bg-emerald-100 dark:bg-emerald-900/40",text:"text-emerald-700 dark:text-emerald-300"},moderate:{emoji:"‚ö†Ô∏è",label:"Mar Moderado",bg:"bg-amber-100 dark:bg-amber-900/40",text:"text-amber-700 dark:text-amber-300"},rough:{emoji:"‚õî",label:"Mar Agitado",bg:"bg-red-100 dark:bg-red-900/40",text:"text-red-700 dark:text-red-300"}}[t];return e.jsxs("div",{className:d("inline-flex items-center gap-2 px-4 py-2 rounded-xl",i.bg),children:[e.jsx("span",{className:"text-xl",children:i.emoji}),e.jsxs("div",{children:[e.jsx("div",{className:d("font-semibold text-sm",i.text),children:i.label}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.toFixed(1),"m ‚Ä¢ ",s,"s"]})]})]})}function be(t){const a=t.find(l=>l.type==="beach"),s=t.find(l=>l.type==="sea"),i=t.filter(l=>l.type==="rain"||l.type==="rain_window"),r=t.filter(l=>l.type==="wind"),n=t.filter(l=>l.type==="temperature"),m=t.filter(l=>l.type==="uv"),c=t.filter(l=>l.type==="warning");return{beach:a,sea:s,rain:i,wind:r,temperature:n,uv:m,warnings:c}}function je({className:t,insights:a,isLoading:s,hasError:i}){const{data:r,isLoading:n,error:m}=le({enabled:a===void 0}),c=a??r?.insights??[],l=s??n,p=i??!!m;if(l)return e.jsx(ve,{});if(p||c.length===0)return e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(o,{icon:"mdi:weather-cloudy-alert",className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"N√£o foi poss√≠vel carregar insights"})]});const{beach:b,sea:j,rain:h,wind:f,temperature:N,uv:g,warnings:_}=be(c);return e.jsxs(x.div,{initial:{opacity:0},animate:{opacity:1},className:d("space-y-4",t),children:[b&&e.jsx(ge,{insight:b}),e.jsxs("div",{className:"grid gap-3",children:[h.length>0&&e.jsx(E,{question:"Vai chover hoje?",icon:"mdi:weather-pouring",insights:h}),j&&e.jsx(E,{question:"Mar t√° como?",icon:"mdi:waves",insights:[j],extra:j.meta?.condition&&e.jsx(fe,{condition:j.meta.condition,waveHeight:j.meta.wave_m??0,period:j.meta.period_s??0})}),f.length>0&&e.jsx(E,{question:"Vai ventar forte?",icon:"mdi:weather-windy",insights:f}),N.length>0&&e.jsx(E,{question:"Vai esfriar/esquentar?",icon:"mdi:thermometer",insights:N}),g.length>0&&e.jsx(E,{question:"Sol forte?",icon:"mdi:white-balance-sunny",insights:g})]}),_.length>0&&e.jsx("div",{className:"mt-4",children:e.jsx(Y,{insights:_})})]})}function E({question:t,icon:a,insights:s,extra:i}){const r=s[0];if(!r)return null;const n={success:"text-emerald-500",info:"text-blue-500",warning:"text-amber-500",danger:"text-red-500"}[r.severity],m={success:"border-emerald-200 dark:border-emerald-700",info:"border-blue-200 dark:border-blue-700",warning:"border-amber-200 dark:border-amber-700",danger:"border-red-200 dark:border-red-700"}[r.severity];return e.jsx(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:e.jsx(w,{className:d("p-4 border-l-4",m),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(o,{icon:a,className:d("h-6 w-6 flex-shrink-0 mt-0.5",n)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground mb-1",children:t}),e.jsx("p",{className:d("text-lg font-medium",n),children:r.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:r.message}),r.detail&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.detail}),i&&e.jsx("div",{className:"mt-3",children:i})]})]})})})}function ve(){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{className:"h-40 rounded-xl"}),e.jsx("div",{className:"grid gap-3",children:[...Array(4)].map((t,a)=>e.jsx(M,{className:"h-24 rounded-xl"},a))})]})}const ye={0:{description:"C√©u limpo",icon:"mdi:weather-sunny",iconNight:"mdi:weather-night",color:"#FFD700"},1:{description:"Predominantemente limpo",icon:"mdi:weather-sunny",iconNight:"mdi:weather-night",color:"#FFD700"},2:{description:"Parcialmente nublado",icon:"mdi:weather-partly-cloudy",iconNight:"mdi:weather-night-partly-cloudy",color:"#87CEEB"},3:{description:"Nublado",icon:"mdi:weather-cloudy",color:"#9CA3AF"},45:{description:"Neblina",icon:"mdi:weather-fog",color:"#9CA3AF"},48:{description:"Neblina congelante",icon:"mdi:weather-fog",color:"#9CA3AF"},51:{description:"Garoa leve",icon:"mdi:weather-rainy",color:"#60A5FA"},53:{description:"Garoa moderada",icon:"mdi:weather-rainy",color:"#60A5FA"},55:{description:"Garoa forte",icon:"mdi:weather-rainy",color:"#3B82F6"},61:{description:"Chuva leve",icon:"mdi:weather-rainy",color:"#3B82F6"},63:{description:"Chuva moderada",icon:"mdi:weather-pouring",color:"#2563EB"},65:{description:"Chuva forte",icon:"mdi:weather-pouring",color:"#1D4ED8"},80:{description:"Pancadas leves",icon:"mdi:weather-pouring",color:"#3B82F6"},81:{description:"Pancadas moderadas",icon:"mdi:weather-pouring",color:"#2563EB"},82:{description:"Pancadas fortes",icon:"mdi:weather-pouring",color:"#1D4ED8"},95:{description:"Tempestade",icon:"mdi:weather-lightning-rainy",color:"#6366F1"},96:{description:"Tempestade com granizo",icon:"mdi:weather-lightning-rainy",color:"#6366F1"},99:{description:"Tempestade severa",icon:"mdi:weather-lightning-rainy",color:"#4F46E5"}};function P(t){return ye[t]??{description:"Desconhecido",icon:"mdi:weather-cloudy",color:"#9CA3AF"}}function V(t){const a=["N","NE","L","SE","S","SO","O","NO"],s=Math.round(t/45)%8;return a[s]}const X={going_out:{title:"Vou sair",icon:"mdi:walk",description:"Chuva, sensa√ß√£o t√©rmica e vento"},beach:{title:"Praia",icon:"mdi:beach",description:"Mar, vento, UV e cobertura"},fishing:{title:"Pescar",icon:"mdi:fish",description:"Ondas, vento e corrente"},hiking:{title:"Trilha",icon:"mdi:hiking",description:"Chuva, sensa√ß√£o e rajadas"}},Ne=["going_out","beach","fishing","hiking"];function we({className:t}){const[a,s]=v.useState(null);return e.jsxs("div",{className:t,children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:Ne.map(i=>{const r=X[i],n=a===i;return e.jsxs(x.button,{whileTap:{scale:.95},onClick:()=>s(n?null:i),className:d("flex-shrink-0 flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all",n?"bg-primary text-primary-foreground shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:[e.jsx(o,{icon:r.icon,className:"h-4 w-4"}),r.title]},i)})}),e.jsx(S,{mode:"wait",children:a&&e.jsx(_e,{type:a,onClose:()=>s(null)},a)})]})}function _e({type:t,onClose:a}){const{data:s,isLoading:i,error:r}=ce(t),n=X[t];return e.jsx(x.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsxs(w,{className:"mt-4 p-4 border-2 border-primary/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{icon:n.icon,className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"font-semibold",children:s?.preset?.title??n.title})]}),e.jsx("button",{onClick:a,className:"text-muted-foreground hover:text-foreground",children:e.jsx(o,{icon:"mdi:close",className:"h-5 w-5"})})]}),i?e.jsxs("div",{className:"py-8 text-center text-muted-foreground",children:[e.jsx(o,{icon:"mdi:loading",className:"h-8 w-8 mx-auto animate-spin"}),e.jsx("p",{className:"mt-2",children:"Carregando..."})]}):r?e.jsxs("div",{className:"py-8 text-center text-muted-foreground",children:[e.jsx(o,{icon:"mdi:alert",className:"h-8 w-8 mx-auto"}),e.jsx("p",{className:"mt-2",children:"Erro ao carregar"})]}):s?.preset?.insights?e.jsx(Y,{insights:s.preset.insights}):e.jsx("p",{className:"text-muted-foreground",children:"Nenhum insight dispon√≠vel"}),s?.preset?.focus&&e.jsx("div",{className:"mt-4 flex gap-2 flex-wrap",children:s.preset.focus.map((m,c)=>e.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded-full",children:m},c))})]})})}function I(t,a){return t.find(s=>s.type===a)?.value??""}function H(t){const s=new Intl.DateTimeFormat("en-CA",{timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).formatToParts(new Date),i=I(s,"year"),r=I(s,"month"),n=I(s,"day"),m=I(s,"hour"),c=I(s,"minute"),l=`${i}-${r}-${n}`,p=`${m}:${c}`;return{date:l,time:p,dateTime:`${l}T${p}`,hour:Number.parseInt(m,10)||0,minute:Number.parseInt(c,10)||0}}function T(t){const a=t.match(/T(\d{2})/);return Number.parseInt(a?.[1]??"0",10)||0}function Z(t,a,s){const i=new Date(`${t}T12:00:00Z`);return new Intl.DateTimeFormat("pt-BR",{...s,timeZone:a}).format(i)}function ke({hours:t,className:a}){const[s,i]=v.useState(null),r=v.useRef(null),n=t.map(h=>h.temp_c),m=Math.floor(Math.min(...n)-2),l=Math.ceil(Math.max(...n)+2)-m,p=Math.max(...t.map(h=>h.rain_prob_pct??0),30),b=v.useCallback(h=>{A("selection"),i(s===h?null:h)},[s]),j=h=>100-(h-m)/l*100;return e.jsxs(w,{className:d("p-4 overflow-hidden",a),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(o,{icon:"mdi:thermometer",className:"h-4 w-4 text-orange-500"}),"Temperatura & Chuva"]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-0.5 bg-orange-500 rounded"}),"Temp"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-blue-400/60 rounded"}),"Chuva"]})]})]}),e.jsxs("div",{ref:r,className:"relative h-32 mt-4",children:[e.jsx("div",{className:"absolute inset-0 flex items-end gap-0.5",children:t.slice(0,24).map((h,f)=>{const N=(h.rain_prob_pct??0)/p*100;return e.jsx(x.div,{initial:{height:0},animate:{height:`${N}%`},transition:{delay:f*.02},onClick:()=>b(f),className:d("flex-1 rounded-t cursor-pointer transition-colors",s===f?"bg-blue-500":"bg-blue-400/40 hover:bg-blue-400/60")},`rain-${f}`)})}),e.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",viewBox:`0 0 ${t.slice(0,24).length*10} 100`,preserveAspectRatio:"none",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"tempGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgb(249, 115, 22)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"rgb(249, 115, 22)",stopOpacity:"0"})]})}),e.jsx("path",{d:`
                            M 0 ${j(t[0].temp_c)}
                            ${t.slice(0,24).map((h,f)=>`L ${f*10+5} ${j(h.temp_c)}`).join(" ")}
                            L ${(t.slice(0,24).length-1)*10+5} 100
                            L 0 100
                            Z
                        `,fill:"url(#tempGradient)"}),e.jsx("path",{d:`
                            M 0 ${j(t[0].temp_c)}
                            ${t.slice(0,24).map((h,f)=>`L ${f*10+5} ${j(h.temp_c)}`).join(" ")}
                        `,fill:"none",stroke:"rgb(249, 115, 22)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),t.slice(0,24).map((h,f)=>e.jsx("circle",{cx:f*10+5,cy:j(h.temp_c),r:s===f?4:2,fill:s===f?"rgb(249, 115, 22)":"white",stroke:"rgb(249, 115, 22)",strokeWidth:"1.5"},`dot-${f}`))]}),e.jsx("div",{className:"absolute inset-0 flex",children:t.slice(0,24).map((h,f)=>e.jsx("div",{onClick:()=>b(f),className:"flex-1 cursor-pointer"},`tap-${f}`))})]}),e.jsx("div",{className:"flex mt-2",children:t.slice(0,24).filter((h,f)=>f%4===0).map((h,f)=>e.jsxs("div",{className:"flex-1 text-center text-xs text-muted-foreground",children:[T(h.t),"h"]},f))}),e.jsx(S,{children:s!==null&&e.jsx(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mt-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl",children:e.jsx(Ce,{hour:t[s]})})})]})}function Ce({hour:t}){return e.jsxs("div",{className:"grid grid-cols-4 gap-3 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Hora"}),e.jsxs("div",{className:"font-semibold",children:[T(t.t),":00"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Temp"}),e.jsxs("div",{className:"font-semibold text-orange-500",children:[Math.round(t.temp_c),"¬∞"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Chuva"}),e.jsxs("div",{className:"font-semibold text-blue-500",children:[t.rain_prob_pct??0,"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Vento"}),e.jsxs("div",{className:"font-semibold",children:[Math.round(t.wind_kmh)," km/h"]})]})]})}function Se({hours:t,className:a}){const[s,i]=v.useState(null),r=Math.max(...t.map(c=>c.wind_kmh),30),n=v.useCallback(c=>{A("selection"),i(s===c?null:c)},[s]),m=({deg:c,size:l=16})=>e.jsx(x.div,{initial:{rotate:0},animate:{rotate:c},style:{width:l,height:l},className:"flex items-center justify-center",children:e.jsx(o,{icon:"mdi:arrow-down",style:{width:l,height:l},className:"text-cyan-500"})});return e.jsxs(w,{className:d("p-4",a),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(o,{icon:"mdi:weather-windy",className:"h-4 w-4 text-cyan-500"}),"Vento & Dire√ß√£o"]}),e.jsx(Te,{title:"O que s√£o rajadas?",message:"Rajadas s√£o picos moment√¢neos de velocidade do vento, geralmente 30-50% mais fortes que o vento m√©dio. S√£o causadas por turbul√™ncia atmosf√©rica e podem ser perigosas para atividades ao ar livre.",tip:"Rajadas acima de 50 km/h requerem cuidado!"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:t.slice(0,24).map((c,l)=>{const p=c.wind_kmh/r*100,b=s===l,j=c.wind_kmh>=30||(c.gust_kmh??0)>=50;return e.jsxs(x.div,{onClick:()=>n(l),whileTap:{scale:.95},className:d("flex-shrink-0 flex flex-col items-center p-2 rounded-xl cursor-pointer transition-colors min-w-[60px]",b?"bg-cyan-100 dark:bg-cyan-900/40":"bg-gray-50 dark:bg-gray-800",j&&"ring-2 ring-amber-400"),children:[e.jsxs("div",{className:"text-xs text-muted-foreground mb-1",children:[T(c.t),"h"]}),e.jsx(m,{deg:c.wind_dir_deg,size:20}),e.jsx("div",{className:"w-3 h-12 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mt-1",children:e.jsx(x.div,{initial:{height:0},animate:{height:`${p}%`},className:d("w-full rounded-full",c.wind_kmh>=30?"bg-amber-500":c.wind_kmh>=15?"bg-cyan-400":"bg-cyan-300"),style:{marginTop:`${100-p}%`}})}),e.jsx("div",{className:d("text-xs font-semibold mt-1",c.wind_kmh>=30?"text-amber-500":"text-foreground"),children:Math.round(c.wind_kmh)})]},l)})}),e.jsx(S,{children:s!==null&&t[s]&&e.jsx(x.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl",children:e.jsx(Ae,{hour:t[s]})})})})]})}function Ae({hour:t}){const a=Me(t.wind_dir_deg);return e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Hora"}),e.jsxs("div",{className:"font-semibold",children:[T(t.t),":00"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Vento"}),e.jsxs("div",{className:"font-semibold text-cyan-500",children:[Math.round(t.wind_kmh)," km/h"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Rajadas"}),e.jsxs("div",{className:d("font-semibold",(t.gust_kmh??0)>=50?"text-amber-500":"text-foreground"),children:[Math.round(t.gust_kmh??0)," km/h"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Dire√ß√£o"}),e.jsx("div",{className:"font-semibold",children:a})]})]})}function Me(t){const a=["N","NE","L","SE","S","SO","O","NO"],s=Math.round(t/45)%8;return a[s]}function Te({title:t,message:a,tip:s}){const[i,r]=v.useState(!1),n=()=>{A("light"),r(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:n,className:"text-xs text-primary flex items-center gap-1 hover:underline",children:[e.jsx(o,{icon:"mdi:help-circle-outline",className:"h-4 w-4"}),"Entenda"]}),e.jsx(S,{children:i&&e.jsxs(e.Fragment,{children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>r(!1),className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50"}),e.jsxs(x.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed left-4 right-4 bottom-4 bg-white dark:bg-gray-900 rounded-2xl p-5 shadow-2xl z-50 max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:e.jsx(o,{icon:"mdi:lightbulb-outline",className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-2",children:t}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:a}),s&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-2",children:e.jsxs("span",{className:"text-xs text-amber-800 dark:text-amber-200",children:["üí° ",s]})})]})]}),e.jsx("button",{onClick:()=>r(!1),className:"mt-4 w-full py-3 bg-gray-100 dark:bg-gray-800 rounded-xl font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:"Entendi"})]})]})})]})}function De(){return e.jsxs(w,{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:[e.jsx(o,{icon:"mdi:school-outline",className:"h-4 w-4"}),"Entenda os termos"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(L,{icon:"mdi:weather-windy-variant",label:"Rajadas",title:"O que s√£o rajadas?",message:"Rajadas s√£o picos moment√¢neos de velocidade do vento, geralmente 30-50% mais fortes que o vento m√©dio. S√£o causadas por turbul√™ncia atmosf√©rica.",tip:"Rajadas acima de 50 km/h s√£o perigosas"}),e.jsx(L,{icon:"mdi:timer-outline",label:"Per√≠odo",title:"O que √© per√≠odo da onda?",message:"O per√≠odo √© o tempo entre uma onda e outra (em segundos). Quanto maior o per√≠odo, mais energia a onda carrega e mais forte ela chega √† praia.",tip:"Per√≠odo > 10s = ondas fortes"}),e.jsx(L,{icon:"mdi:waves",label:"Swell",title:"O que √© swell?",message:"Swell s√£o ondas que viajaram de longe, geradas por tempestades distantes no oceano. Chegam organizadas, com mais energia e maiores que as ondas locais.",tip:"Swell grande mesmo sem vento local = mar forte"}),e.jsx(L,{icon:"mdi:weather-sunny-alert",label:"√çndice UV",title:"O que √© √≠ndice UV?",message:"O √≠ndice UV mede a intensidade da radia√ß√£o ultravioleta do sol. Valores acima de 6 requerem prote√ß√£o solar, acima de 11 √© extremo.",tip:"UV > 8: use protetor, chap√©u e √≥culos"})]})]})}function L({icon:t,label:a,title:s,message:i,tip:r}){const[n,m]=v.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{A("light"),m(!0)},className:"flex items-center gap-2 p-2 rounded-lg bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left",children:[e.jsx(o,{icon:t,className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-sm",children:a}),e.jsx(o,{icon:"mdi:help-circle-outline",className:"h-4 w-4 text-muted-foreground ml-auto"})]}),e.jsx(S,{children:n&&e.jsxs(e.Fragment,{children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>m(!1),className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50"}),e.jsxs(x.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed left-4 right-4 bottom-4 bg-white dark:bg-gray-900 rounded-2xl p-5 shadow-2xl z-50 max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:e.jsx(o,{icon:t,className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-2",children:s}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:i}),r&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-2",children:e.jsxs("span",{className:"text-xs text-amber-800 dark:text-amber-200",children:["üí° ",r]})})]})]}),e.jsx("button",{onClick:()=>m(!1),className:"mt-4 w-full py-3 bg-gray-100 dark:bg-gray-800 rounded-xl font-medium",children:"Entendi"})]})]})})]})}function Fe({className:t}){const{isOffline:a}=W();return e.jsx(S,{children:a&&e.jsxs(x.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:d("fixed top-0 left-0 right-0 z-[100]","bg-amber-500 text-white px-4 py-2","flex items-center justify-center gap-2 text-sm font-medium","safe-area-top",t),children:[e.jsx(o,{icon:"mdi:wifi-off",className:"h-4 w-4"}),e.jsx("span",{children:"Voc√™ est√° offline"}),e.jsx("span",{className:"text-amber-200",children:"‚Ä¢ Dados em cache"})]})})}function Oe({cacheStatus:t,compact:a=!1,className:s}){const{isOnline:i}=W();if(t.isUpdating)return e.jsxs(x.div,{initial:{opacity:0},animate:{opacity:1},className:d("flex items-center gap-1.5 text-xs","text-blue-600 dark:text-blue-400",s),children:[e.jsx(o,{icon:"mdi:loading",className:"h-3.5 w-3.5 animate-spin"}),!a&&e.jsx("span",{children:"Atualizando..."})]});if(!i)return e.jsxs("div",{className:d("flex items-center gap-1.5 text-xs","text-amber-600 dark:text-amber-400",s),children:[e.jsx(o,{icon:"mdi:wifi-off",className:"h-3.5 w-3.5"}),!a&&e.jsx("span",{children:"Offline"})]});if(t.isStale)return e.jsxs("div",{className:d("flex items-center gap-1.5 text-xs","text-amber-600 dark:text-amber-400",s),children:[e.jsx(o,{icon:"mdi:clock-alert-outline",className:"h-3.5 w-3.5"}),!a&&e.jsx("span",{children:"Dados antigos"})]});if(t.cachedAt){const r=Q(t.cachedAt);return e.jsxs("div",{className:d("flex items-center gap-1.5 text-xs text-muted-foreground",s),children:[e.jsx(o,{icon:"mdi:check-circle-outline",className:"h-3.5 w-3.5 text-green-500"}),!a&&e.jsxs("span",{children:["Atualizado ",r]})]})}return null}function Pe({cacheStatus:t,onRefresh:a,className:s}){const{isOnline:i}=W();return!t.isStale&&i?null:e.jsx(x.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:d("p-3 rounded-xl text-sm",i?"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800":"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800",s),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(o,{icon:i?"mdi:clock-alert-outline":"mdi:wifi-off",className:d("h-5 w-5 mt-0.5",i?"text-blue-500":"text-amber-500")}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:d("font-medium mb-1",i?"text-blue-800 dark:text-blue-200":"text-amber-800 dark:text-amber-200"),children:i?"Dados podem estar desatualizados":"Voc√™ est√° offline"}),e.jsx("p",{className:"text-muted-foreground",children:t.cachedAt&&e.jsxs(e.Fragment,{children:["√öltima atualiza√ß√£o: ",Q(t.cachedAt)]})})]}),i&&a&&e.jsx("button",{onClick:a,className:"px-3 py-1.5 bg-blue-500 text-white rounded-lg text-xs font-medium hover:bg-blue-600 transition-colors",children:"Atualizar"})]})})}const Ee={wave_height:{title:"Altura das Ondas",simple:"O tamanho das ondas do mar",detail:"Medida da base ao topo da onda. Ondas acima de 1.5m s√£o consideradas grandes e podem ser perigosas para banhistas.",icon:"mdi:waves",tip:"At√© 0.5m = calmo, 0.5-1m = moderado, >1.5m = agitado"},wave_period:{title:"Per√≠odo da Onda",simple:"O tempo entre uma onda e outra",detail:"Quanto maior o per√≠odo, mais energia a onda carrega. Per√≠odos longos (>10s) indicam ondula√ß√£o de alto mar (swell) que chega com for√ßa.",icon:"mdi:timer-outline",tip:"Per√≠odo curto (<6s) = ondas locais. Per√≠odo longo (>10s) = ondas mais fortes"},wave_direction:{title:"Dire√ß√£o da Onda",simple:"De onde as ondas est√£o vindo",detail:"Indica a origem das ondas. Importante para surfistas (entender a forma√ß√£o) e para quem est√° na praia (prote√ß√£o natural de ba√≠as).",icon:"mdi:compass",tip:"Compare com a orienta√ß√£o da praia para saber se est√° protegida"},swell:{title:"Swell (Ondula√ß√£o)",simple:"Ondas que viajaram de longe",detail:"S√£o ondas geradas por tempestades distantes no oceano. Chegam organizadas e com mais energia que as ondas locais.",icon:"mdi:wave",tip:"Swell grande + per√≠odo longo = mar forte mesmo sem vento local"},sea_temp:{title:"Temperatura do Mar",simple:"Qu√£o quente ou fria est√° a √°gua",detail:"A temperatura da superf√≠cie do mar. Varia com as correntes, esta√ß√£o e profundidade.",icon:"mdi:thermometer",tip:"Acima de 25¬∞C = confort√°vel. Abaixo de 20¬∞C = √°gua fria"},current:{title:"Corrente Marinha",simple:"Movimento da √°gua no mar",detail:"A velocidade e dire√ß√£o do fluxo de √°gua. Correntes fortes podem arrastar banhistas e dificultar a nata√ß√£o.",icon:"mdi:current-ac",tip:"Acima de 0.5 m/s requer aten√ß√£o. N√£o lute contra a corrente!"},wind_wave:{title:"Ondas de Vento",simple:"Ondas criadas pelo vento local",detail:"Estas ondas s√£o geradas pelo vento que est√° soprando agora. S√£o mais curtas e desorganizadas que o swell.",icon:"mdi:weather-windy",tip:'Com muito vento, o mar fica "picado" mesmo com ondas pequenas'}};function F({metricKey:t,value:a,unit:s="",className:i,size:r="md",showLabel:n=!0}){const[m,c]=v.useState(!1),l=Ee[t];if(!l)return null;const p={sm:{icon:"h-4 w-4",value:"text-sm",label:"text-xs"},md:{icon:"h-5 w-5",value:"text-lg",label:"text-xs"},lg:{icon:"h-6 w-6",value:"text-2xl",label:"text-sm"}}[r];return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>c(!0),className:d("text-left group relative","hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg p-2 -m-2 transition-colors",i),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{icon:l.icon,className:d(p.icon,"text-cyan-600")}),e.jsxs("div",{children:[e.jsxs("div",{className:d("font-bold",p.value),children:[a,s]}),n&&e.jsxs("div",{className:d("text-muted-foreground flex items-center gap-1",p.label),children:[l.title,e.jsx(o,{icon:"mdi:help-circle-outline",className:"h-3 w-3 opacity-50 group-hover:opacity-100"})]})]})]})}),e.jsx(Ie,{isOpen:m,onClose:()=>c(!1),explanation:l})]})}function Ie({isOpen:t,onClose:a,explanation:s}){return e.jsx(S,{children:t&&e.jsxs(e.Fragment,{children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:a,className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50"}),e.jsxs(x.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed left-4 right-4 bottom-4 bg-white dark:bg-gray-900 rounded-2xl p-5 shadow-2xl z-50 max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-full bg-cyan-100 dark:bg-cyan-900/40",children:e.jsx(o,{icon:s.icon,className:"h-6 w-6 text-cyan-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-1",children:s.title}),e.jsx("p",{className:"text-lg text-cyan-600 dark:text-cyan-400 mb-2",children:s.simple}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:s.detail}),s.tip&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(o,{icon:"mdi:lightbulb-outline",className:"h-4 w-4 text-amber-600 mt-0.5"}),e.jsx("span",{className:"text-sm text-amber-800 dark:text-amber-200",children:s.tip})]})})]})]}),e.jsx("button",{onClick:a,className:"mt-4 w-full py-3 bg-gray-100 dark:bg-gray-800 rounded-xl font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:"Entendi"})]})]})})}function Le({className:t}){const[a,s]=v.useState(!1);return e.jsxs("div",{className:t,children:[e.jsx(x.button,{onClick:()=>s(!a),className:d("w-full p-3 rounded-xl text-left transition-colors","bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{icon:"mdi:information-outline",className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Dados do mar t√™m precis√£o limitada perto da costa"}),e.jsx(o,{icon:"mdi:chevron-down",className:d("h-4 w-4 ml-auto text-blue-500 transition-transform",a&&"rotate-180")})]})}),e.jsx(S,{children:a&&e.jsx(x.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsxs("div",{className:"p-4 pt-2 text-sm text-muted-foreground space-y-2",children:[e.jsx("p",{children:"Os modelos meteorol√≥gicos usam grades de ~5km, ent√£o dados pr√≥ximos √† costa podem ser influenciados por c√©lulas terrestres."}),e.jsxs("p",{children:["Usamos a configura√ß√£o ",e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"cell_selection=sea"}),"para priorizar dados oce√¢nicos, mas em praias muito rasas ou ba√≠as protegidas a realidade pode diferir."]}),e.jsx("p",{className:"font-medium text-foreground",children:"üí° Sempre observe as condi√ß√µes locais antes de entrar no mar."})]})})})]})}function ze({height:t,condition:a,className:s}){const i=a==="calm"?3:a==="moderate"?2:1,r=a==="calm"?2:a==="moderate"?4:6;return e.jsx(x.div,{animate:{y:[-r,r,-r]},transition:{duration:i,repeat:1/0,ease:"easeInOut"},className:s,children:e.jsx(o,{icon:"mdi:waves",className:d("h-8 w-8",a==="calm"&&"text-emerald-500",a==="moderate"&&"text-amber-500",a==="rough"&&"text-red-500")})})}function Be({waveHeight:t,wavePeriod:a,seaTemp:s,className:i}){const r=t>=1.5||t>=1&&a>=10?"rough":t>=.8?"moderate":"calm",n={calm:{emoji:"‚úÖ",label:"Mar Calmo",description:"Bom para banho e atividades aqu√°ticas",bg:"from-emerald-400 to-emerald-600",textColor:"text-white"},moderate:{emoji:"‚ö†Ô∏è",label:"Mar Moderado",description:"Aten√ß√£o para banhistas iniciantes",bg:"from-amber-400 to-amber-600",textColor:"text-white"},rough:{emoji:"‚õî",label:"Mar Agitado",description:"Cuidado! Ondas fortes",bg:"from-red-400 to-red-600",textColor:"text-white"}}[r];return e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:d("rounded-2xl p-5 bg-gradient-to-r shadow-lg",n.bg,n.textColor,i),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-2xl",children:n.emoji}),e.jsx("h3",{className:"text-xl font-bold",children:n.label})]}),e.jsx("p",{className:"text-white/90 text-sm",children:n.description})]}),e.jsx(ze,{height:t,condition:r})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-4",children:[e.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center backdrop-blur-sm",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[t.toFixed(1),"m"]}),e.jsx("div",{className:"text-xs text-white/80",children:"Altura"})]}),e.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center backdrop-blur-sm",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a.toFixed(0),"s"]}),e.jsx("div",{className:"text-xs text-white/80",children:"Per√≠odo"})]}),s!==void 0&&e.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center backdrop-blur-sm",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(s),"¬∞C"]}),e.jsx("div",{className:"text-xs text-white/80",children:"√Ågua"})]})]})]})}function z(t){return t&&typeof t=="object"&&!Array.isArray(t)?t:{}}function O(t){return Array.isArray(t)?t.filter(a=>typeof a=="string"):[]}function u(t){return Array.isArray(t)?t.map(a=>typeof a=="number"?a:Number(a)).map(a=>Number.isFinite(a)?a:0):[]}function k(t,a=0){if(typeof t=="number"&&Number.isFinite(t))return t;const s=Number(t);return Number.isFinite(s)?s:a}function J(t){const a=t.split("-").filter(Boolean);if(a.length<2)return t||"Cidade";const s=(a.pop()??"").toUpperCase();return`${a.map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")}/${s}`}function ee(t){return{provider:t.provider,cached:!0,stale:t.cache.degraded,fetched_at:t.cache.generated_at_utc,expires_at:t.cache.expires_at_utc}}function $e(t){if(Object.keys(t).length===0)return;const a=k(t.weather_code,0);return{temp_c:k(t.temperature_2m),feels_like_c:k(t.apparent_temperature),weather_code:a,description:P(a).description,precipitation_mm:k(t.precipitation),wind_kmh:k(t.wind_speed_10m),gust_kmh:k(t.wind_gusts_10m),wind_dir_deg:k(t.wind_direction_10m),cloud_cover_pct:k(t.cloud_cover)}}function qe(t,a,s){const i=O(t.time),r=u(t.temperature_2m),n=u(t.precipitation_probability),m=u(t.precipitation),c=u(t.weather_code),l=u(t.wind_speed_10m),p=u(t.wind_gusts_10m),b=u(t.wind_direction_10m),j=u(t.uv_index),h=u(t.cloud_cover),f=H(a).dateTime,N=[];for(let g=0;g<i.length;g+=1){const _=i[g];if(!(!_||_<f)&&(N.push({t:_,temp_c:r[g]??0,rain_prob_pct:n[g]??0,precipitation_mm:m[g]??0,weather_code:c[g]??0,wind_kmh:l[g]??0,gust_kmh:p[g]??0,wind_dir_deg:b[g]??0,uv_index:j[g]??0,cloud_cover_pct:h[g]??0}),N.length>=s))break}return N}function Re(t,a){const s=O(t.time),i=u(t.weather_code),r=u(t.temperature_2m_min),n=u(t.temperature_2m_max),m=u(t.precipitation_sum),c=u(t.precipitation_probability_max),l=u(t.wind_speed_10m_max),p=u(t.wind_gusts_10m_max),b=u(t.wind_direction_10m_dominant),j=O(t.sunrise),h=O(t.sunset),f=u(t.uv_index_max),N=[];for(let g=0;g<s.length;g+=1){const _=s[g],C=i[g]??0;if(N.push({date:_,weather_code:C,description:P(C).description,min_c:r[g]??0,max_c:n[g]??0,precipitation_sum_mm:m[g]??0,rain_prob_max_pct:c[g]??0,wind_max_kmh:l[g]??0,gust_max_kmh:p[g]??0,wind_dir_dominant_deg:b[g]??0,sunrise:j[g],sunset:h[g],uv_max:f[g]??0}),N.length>=a)break}return N}function Ve(t,a,s){const i=O(t.time),r=u(t.wave_height),n=u(t.wave_period),m=u(t.wave_direction),c=u(t.swell_wave_height),l=u(t.swell_wave_period),p=u(t.swell_wave_direction),b=u(t.wind_wave_height),j=u(t.wind_wave_period),h=u(t.wind_wave_direction),f=u(t.sea_surface_temperature),N=u(t.ocean_current_velocity),g=u(t.ocean_current_direction),_=H(a).dateTime,C=[];for(let y=0;y<i.length;y+=1){const D=i[y];if(!(!D||D<_)&&(C.push({t:D,wave_m:r[y]??0,wave_period_s:n[y]??0,wave_dir_deg:m[y]??0,swell_m:c[y]??0,swell_period_s:l[y]??0,swell_dir_deg:p[y]??0,wind_wave_m:b[y]??0,wind_wave_period_s:j[y]??0,wind_wave_dir_deg:h[y]??0,sea_temp_c:f[y],current_ms:N[y]??0,current_dir_deg:g[y]??0}),C.length>=s))break}return C}function We(t,a){const s=O(t.time),i=u(t.wave_height_max),r=u(t.wave_period_max),n=u(t.wave_direction_dominant),m=u(t.swell_wave_height_max),c=u(t.swell_wave_period_max),l=u(t.swell_wave_direction_dominant),p=[];for(let b=0;b<s.length&&(p.push({date:s[b],wave_max_m:i[b]??0,wave_period_max_s:r[b]??0,wave_dir_dominant_deg:n[b]??0,swell_max_m:m[b]??0,swell_period_max_s:c[b]??0,swell_dir_dominant_deg:l[b]??0}),!(p.length>=a));b+=1);return p}function He(t,a){if(!t)return;const s=t.location.timezone||"America/Sao_Paulo",i=$e(z(t.data.current)),r=qe(z(t.data.hourly),s,a?.hoursLimit),n=Re(z(t.data.daily),a?.daysLimit);return{location:{key:t.location.city_slug,name:J(t.location.city_slug),lat:k(t.location.lat),lon:k(t.location.lon),timezone:s},cache:ee(t),current:i,hourly:r,daily:n}}function Ue(t,a){if(!t||!t.data.marine)return;const s=t.location.timezone||"America/Sao_Paulo",i=z(t.data.marine);return{location:{key:t.location.city_slug,name:J(t.location.city_slug),lat:k(t.location.lat),lon:k(t.location.lon),timezone:s},cache:ee(t),hourly:Ve(i,s,a?.hoursLimit),daily:We(i,a?.daysLimit)}}function Ge(t){const a=t?.data?.insights;return Array.isArray(a)?a:[]}const te="weather-view-mode";function Ke(){return typeof window>"u"?"simple":localStorage.getItem(te)||"simple"}function Ze(t){localStorage.setItem(te,t)}function xt(){const t=ne(),[a,s]=v.useState("hoje"),[i,r]=v.useState(Ke);v.useEffect(()=>{Ze(i)},[i]);const{data:n,isLoading:m,refetch:c,cacheStatus:l}=K({sections:["current","hourly","daily","insights"],days:10,units:"metric"}),p=v.useMemo(()=>He(n,{hoursLimit:48,daysLimit:10}),[n]),b=v.useMemo(()=>Ge(n),[n]),j=n?.location.timezone??"America/Sao_Paulo",h=n?.location.is_coastal??!1,f=h&&i==="detailed"&&a==="mar",{data:N,isLoading:g,refetch:_}=K({sections:["marine"],days:8,units:"metric"},{enabled:f}),C=v.useMemo(()=>Ue(N,{hoursLimit:48,daysLimit:8}),[N]);v.useEffect(()=>{a==="mar"&&!h&&s("hoje")},[a,h]);const y=m||f&&g,D=v.useCallback(async()=>{if(A("light"),f){await Promise.all([c(),_()]);return}await c()},[c,_,f]),U=v.useCallback($=>{A("selection"),r($)},[]),ae=v.useCallback($=>{A("selection"),s($)},[]);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-sky-100 via-blue-50 to-white dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:[e.jsx(Fe,{}),e.jsxs("header",{className:"sticky top-0 z-50 border-b border-gray-200/50 bg-white/80 backdrop-blur-xl dark:border-gray-700/50 dark:bg-gray-900/80",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx(G,{variant:"ghost",size:"icon",onClick:()=>t(-1),className:"rounded-full",children:e.jsx(se,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Previsao do Tempo"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:p?.location?.name??"Cidade"})]}),e.jsx(G,{variant:"ghost",size:"icon",onClick:D,disabled:y,className:"rounded-full",children:e.jsx(ie,{className:d("h-5 w-5",y&&"animate-spin")})})]}),p?.current&&e.jsx(Qe,{current:p.current})]}),e.jsxs("main",{className:"pb-20",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("div",{className:"mb-2 flex items-center justify-end",children:e.jsx(Oe,{cacheStatus:l})}),e.jsx(Pe,{cacheStatus:l,onRefresh:D,className:"mb-3"}),e.jsxs("div",{className:"mx-auto flex max-w-[280px] items-center justify-center gap-1 rounded-xl bg-gray-100 p-1 dark:bg-gray-800",children:[e.jsxs(x.button,{onClick:()=>U("simple"),className:d("relative flex-1 rounded-lg px-4 py-2 text-sm font-medium transition-all",i==="simple"?"text-primary":"text-muted-foreground hover:text-foreground"),children:[i==="simple"&&e.jsx(x.div,{layoutId:"modeIndicator",className:"absolute inset-0 rounded-lg bg-white shadow dark:bg-gray-700",transition:{type:"spring",damping:20,stiffness:300}}),e.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-1",children:[e.jsx(o,{icon:"mdi:lightbulb-outline",className:"h-4 w-4"}),"Simples"]})]}),e.jsxs(x.button,{onClick:()=>U("detailed"),className:d("relative flex-1 rounded-lg px-4 py-2 text-sm font-medium transition-all",i==="detailed"?"text-primary":"text-muted-foreground hover:text-foreground"),children:[i==="detailed"&&e.jsx(x.div,{layoutId:"modeIndicator",className:"absolute inset-0 rounded-lg bg-white shadow dark:bg-gray-700",transition:{type:"spring",damping:20,stiffness:300}}),e.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-1",children:[e.jsx(o,{icon:"mdi:chart-line",className:"h-4 w-4"}),"Detalhado"]})]})]})]}),e.jsx(S,{mode:"wait",children:i==="simple"?e.jsxs(x.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"px-4 pt-2",children:[e.jsx(we,{className:"mb-4"}),e.jsx(je,{insights:b,isLoading:m,hasError:!!n?.errors?.insights})]},"simple"):e.jsx(x.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},children:e.jsxs(oe,{value:a,onValueChange:ae,className:"w-full",children:[e.jsx("div",{className:"sticky top-[120px] z-40 border-b border-gray-200/50 bg-white/80 px-4 py-2 backdrop-blur-xl dark:border-gray-700/50 dark:bg-gray-900/80",children:e.jsxs(de,{className:d("grid w-full rounded-xl bg-gray-100 p-1 dark:bg-gray-800",h?"grid-cols-3":"grid-cols-2"),children:[e.jsxs(q,{value:"hoje",className:"rounded-lg data-[state=active]:bg-white data-[state=active]:shadow dark:data-[state=active]:bg-gray-700",children:[e.jsx(o,{icon:"mdi:clock-outline",className:"mr-1 h-4 w-4"}),"Hoje"]}),e.jsxs(q,{value:"dias",className:"rounded-lg data-[state=active]:bg-white data-[state=active]:shadow dark:data-[state=active]:bg-gray-700",children:[e.jsx(o,{icon:"mdi:calendar",className:"mr-1 h-4 w-4"}),"10 Dias"]}),h&&e.jsxs(q,{value:"mar",className:"rounded-lg data-[state=active]:bg-white data-[state=active]:shadow dark:data-[state=active]:bg-gray-700",children:[e.jsx(o,{icon:"mdi:waves",className:"mr-1 h-4 w-4"}),"Mar"]})]})}),e.jsxs(S,{mode:"wait",children:[e.jsx(R,{value:"hoje",className:"mt-0 px-4 pt-4",children:m?e.jsx(et,{}):p?.hourly&&p.hourly.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx(ke,{hours:p.hourly}),e.jsx(Se,{hours:p.hourly}),e.jsx(De,{}),e.jsx(Ye,{hours:p.hourly})]}):e.jsx(B,{message:"Dados nao disponiveis"})}),e.jsx(R,{value:"dias",className:"mt-0 px-4 pt-4",children:m?e.jsx(tt,{}):p?.daily&&p.daily.length>0?e.jsx(Xe,{days:p.daily,timezone:j}):e.jsx(B,{message:"Dados nao disponiveis"})}),h&&e.jsx(R,{value:"mar",className:"mt-0 px-4 pt-4",children:g?e.jsx(at,{}):C?.hourly&&C.hourly.length>0?e.jsx(Je,{hours:C.hourly}):e.jsx(B,{message:"Dados do mar indisponiveis"})})]})]})},"detailed")}),n?.cache&&e.jsx("div",{className:"px-4 py-6 text-center text-xs text-muted-foreground",children:e.jsxs("p",{children:["Atualizado"," ",re(new Date(n.cache.generated_at_utc),{addSuffix:!0,locale:me}),n.cache.degraded&&e.jsx("span",{className:"ml-1 text-amber-500",children:"(degradado)"})]})})]})]})}function Qe({current:t}){const a=P(t.weather_code);return e.jsx(x.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-sky-500 via-blue-500 to-indigo-500 px-4 py-3 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{icon:a.icon,className:"h-10 w-10"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(t.temp_c),"C"]}),e.jsx("div",{className:"text-sm text-white/80",children:t.description})]})]}),e.jsxs("div",{className:"space-y-1 text-right text-sm",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(o,{icon:"mdi:thermometer",className:"h-4 w-4"}),e.jsxs("span",{children:["Sensacao ",Math.round(t.feels_like_c),"C"]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(o,{icon:"mdi:weather-windy",className:"h-4 w-4"}),e.jsxs("span",{children:[Math.round(t.wind_kmh)," km/h ",V(t.wind_dir_deg)]})]})]})]})})}function Ye({hours:t}){return e.jsxs(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-3",children:[e.jsxs(w,{className:"bg-gradient-to-r from-sky-100 to-blue-100 p-4 dark:from-gray-800 dark:to-gray-700",children:[e.jsx("h3",{className:"mb-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Proximas horas"}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:t.slice(0,12).map((a,s)=>{const i=s===0,r=P(a.weather_code);return e.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:s*.05},className:d("min-w-[70px] flex-shrink-0 rounded-xl p-3 text-center",i?"bg-blue-500 text-white shadow-lg":"bg-white/80 dark:bg-gray-600/50"),children:[e.jsx("div",{className:"mb-1 text-xs font-medium",children:i?"Agora":`${T(a.t)}h`}),e.jsx(o,{icon:r.icon,className:"mx-auto my-1 h-6 w-6"}),e.jsxs("div",{className:"text-lg font-bold",children:[Math.round(a.temp_c),"C"]}),a.rain_prob_pct>0&&e.jsxs("div",{className:d("mt-1 text-xs",i?"text-white/80":"text-blue-500"),children:[a.rain_prob_pct,"%"]})]},a.t)})})]}),e.jsx("div",{className:"space-y-2",children:t.slice(0,24).map((a,s)=>{const i=P(a.weather_code);return e.jsx(x.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:s*.02},children:e.jsx(w,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 text-center",children:e.jsxs("div",{className:"text-sm font-medium",children:[T(a.t),":00"]})}),e.jsx(o,{icon:i.icon,className:"h-6 w-6",style:{color:i.color}}),e.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(a.temp_c),"C"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[a.rain_prob_pct>0&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-500",children:[e.jsx(o,{icon:"mdi:water",className:"h-4 w-4"}),a.rain_prob_pct,"%"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{icon:"mdi:weather-windy",className:"h-4 w-4"}),Math.round(a.wind_kmh)]})]})]})})},a.t)})})]})}function Xe({days:t,timezone:a}){const s=H(a).date;return e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-2",children:t.map((i,r)=>{const n=i.date===s,m=P(i.weather_code),c=n?"Hoje":Z(i.date,a,{weekday:"short"}).replace(".",""),l=Z(i.date,a,{day:"numeric",month:"short"});return e.jsx(x.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.05},children:e.jsx(w,{className:d("p-4",n&&"border-2 border-blue-400 bg-blue-50 dark:bg-blue-900/20"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:d("text-sm font-semibold capitalize",n&&"text-blue-600 dark:text-blue-400"),children:c}),e.jsx("div",{className:"text-xs text-muted-foreground",children:l})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{icon:m.icon,className:"h-8 w-8",style:{color:m.color}}),e.jsx("span",{className:"hidden text-xs text-muted-foreground sm:block",children:i.description})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[i.rain_prob_max_pct!==void 0&&i.rain_prob_max_pct>0&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-blue-500",children:[e.jsx(o,{icon:"mdi:water",className:"h-4 w-4"}),i.rain_prob_max_pct,"%"]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"text-lg font-bold text-orange-500",children:[Math.round(i.max_c),"C"]}),e.jsx("span",{className:"mx-1 text-muted-foreground",children:"/"}),e.jsxs("span",{className:"text-lg font-bold text-blue-500",children:[Math.round(i.min_c),"C"]})]})]})]})})},i.date)})})}function Je({hours:t}){const a=t[0];if(!a)return e.jsx(B,{message:"Dados do mar indisponiveis"});const s=i=>i>=1.5?"text-red-500":i>=.8?"text-amber-500":"text-emerald-500";return e.jsxs(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-4",children:[e.jsx(Be,{waveHeight:a.wave_m,wavePeriod:a.wave_period_s,seaTemp:a.sea_temp_c}),e.jsx(Le,{}),e.jsxs(w,{className:"p-4",children:[e.jsxs("h3",{className:"mb-4 flex items-center gap-2 text-sm font-medium",children:[e.jsx(o,{icon:"mdi:information-outline",className:"h-4 w-4 text-muted-foreground"}),"Toque para entender cada metrica"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(F,{metricKey:"wave_height",value:a.wave_m.toFixed(1),unit:"m",size:"lg"}),e.jsx(F,{metricKey:"wave_period",value:a.wave_period_s.toFixed(0),unit:"s",size:"lg"}),e.jsx(F,{metricKey:"wave_direction",value:V(a.wave_dir_deg),size:"lg"}),a.sea_temp_c!==void 0&&e.jsx(F,{metricKey:"sea_temp",value:Math.round(a.sea_temp_c),unit:"C",size:"lg"})]})]}),a.swell_m!==void 0&&a.swell_m>0&&e.jsxs(w,{className:"p-4",children:[e.jsxs("h3",{className:"mb-3 flex items-center gap-2 text-sm font-medium",children:[e.jsx(o,{icon:"mdi:wave",className:"h-4 w-4 text-blue-500"}),"Swell"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(F,{metricKey:"swell",value:a.swell_m.toFixed(1),unit:"m",size:"md"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold",children:[a.swell_period_s?.toFixed(0)??"-","s"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Periodo"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold",children:V(a.swell_dir_deg??0)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Direcao"})]})]})]}),a.current_ms!==void 0&&a.current_ms>0&&e.jsx(w,{className:"p-4",children:e.jsx(F,{metricKey:"current",value:a.current_ms.toFixed(2),unit:" m/s",size:"lg"})}),e.jsxs(w,{className:"p-4",children:[e.jsx("h3",{className:"mb-3 text-sm font-medium",children:"Previsao por hora"}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:t.slice(0,12).map((i,r)=>{const n=s(i.wave_m);return e.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:r*.05},className:"min-w-[70px] flex-shrink-0 rounded-xl bg-cyan-50 p-3 text-center dark:bg-cyan-900/20",children:[e.jsxs("div",{className:"mb-1 text-xs font-medium",children:[T(i.t),"h"]}),e.jsx(o,{icon:"mdi:waves",className:d("mx-auto h-5 w-5",n)}),e.jsxs("div",{className:d("mt-1 text-sm font-bold",n),children:[i.wave_m.toFixed(1),"m"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[i.wave_period_s.toFixed(0),"s"]})]},i.t)})})]})]})}function et(){return e.jsxs("div",{className:"space-y-3",children:[e.jsx(M,{className:"h-32 rounded-xl"}),e.jsx("div",{className:"space-y-2",children:[...Array(6)].map((t,a)=>e.jsx(M,{className:"h-16 rounded-xl"},a))})]})}function tt(){return e.jsx("div",{className:"space-y-2",children:[...Array(7)].map((t,a)=>e.jsx(M,{className:"h-20 rounded-xl"},a))})}function at(){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{className:"h-40 rounded-xl"}),e.jsx(M,{className:"h-24 rounded-xl"})]})}function B({message:t}){return e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(o,{icon:"mdi:weather-cloudy-alert",className:"mx-auto h-16 w-16 text-muted-foreground"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:t})]})}export{xt as default};
