import{r as h,j as e,bp as S,b1 as T,ba as g,bv as R,z,bI as B,y as u,x as A,b2 as L,a6 as M,aJ as f,m as F,bw as I,M as E}from"./vendor-app-D_TKIhWN.js";import{u as _,B as d,c as o}from"./index-CHPK4Zgg.js";import{B as O}from"./badge-zHxpUfr-.js";import{C as c}from"./card-BNPSHgr1.js";import{I as P}from"./input-WZ1IEVEw.js";import{a as q}from"./useCityName-CXJzs642.js";import{b as D,c as Q}from"./useMyReports-BqpZvztH.js";import{B as U}from"./BottomTabBar-Nb_mBAXt.js";import{C as $}from"./CategoryIcon-DxXg9Xqh.js";import{p as J}from"./pt-BR-DGjP7oKQ.js";import"./iconify-Bl2-U9FG.js";const p={recebido:{label:"Recebido",color:"bg-blue-100 text-blue-700",icon:f},em_analise:{label:"Em verificação",color:"bg-amber-100 text-amber-700",icon:M},resolvido:{label:"Melhoria concluída",color:"bg-green-100 text-green-700",icon:g},rejeitado:{label:"Arquivado",color:"bg-slate-100 text-slate-700",icon:L}};function te({scrollRef:j}){const i=_(),[a,l]=h.useState("all"),[m,v]=h.useState(""),{name:N}=q(),{stats:t,isLoading:r}=D(),{reports:x,isLoading:b}=Q({status:a==="all"?void 0:a,search:m||void 0}),w=()=>{i("/observacao/nova")},y=s=>{i(`/observacao/${s}`)},k=s=>{i(`/?tab=${s}`)};return e.jsxs("div",{ref:j,className:"relative min-h-screen bg-slate-50 dark:bg-slate-950",children:[e.jsxs("div",{className:"pb-32",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 border-b pb-6 rounded-b-[2rem] shadow-sm relative z-10",children:[e.jsxs("div",{className:"px-4 pt-4 pb-2 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent",children:["Observa ",N]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Acompanhe as melhorias na cidade"})]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>i("/observacoes/mapa"),className:"shrink-0 gap-1.5",children:[e.jsx(S,{className:"w-4 h-4"}),"Mapa"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 px-4 mt-2",children:[e.jsxs(c,{className:"p-3 bg-gradient-to-br from-blue-50 to-white border-blue-100 dark:from-blue-950/30 dark:to-slate-900 dark:border-blue-900 shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition-opacity",children:e.jsx(T,{className:"w-12 h-12 text-blue-600"})}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium uppercase tracking-wider",children:"Total"}),e.jsxs("div",{className:"flex items-end gap-2 mt-1",children:[e.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"...":t.total}),e.jsx("span",{className:"text-[10px] text-blue-600/80 mb-1 font-medium",children:"observações"})]})]}),e.jsxs(c,{className:"p-3 bg-gradient-to-br from-green-50 to-white border-green-100 dark:from-green-950/30 dark:to-slate-900 dark:border-green-900 shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition-opacity",children:e.jsx(g,{className:"w-12 h-12 text-green-600"})}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 font-medium uppercase tracking-wider",children:"Resolvidas"}),e.jsxs("div",{className:"flex items-end gap-2 mt-1",children:[e.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"...":t.byStatus.resolvido}),e.jsx("span",{className:"text-[10px] text-green-600/80 mb-1 font-medium",children:"casos"})]})]})]}),e.jsxs("div",{className:"flex gap-2 px-4 mt-4 overflow-x-auto pb-2 scrollbar-none",children:[e.jsxs("button",{onClick:()=>l("em_analise"),title:"A comunidade está confirmando as informações.",className:o("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium border transition-all whitespace-nowrap",a==="em_analise"?"bg-amber-100 border-amber-200 text-amber-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"),children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500"}),"Em verificação (",r?"-":t.byStatus.em_analise,")"]}),e.jsxs("button",{onClick:()=>l("rejeitado"),title:"Faltaram detalhes, era duplicado, ou não foi possível confirmar.",className:o("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium border transition-all whitespace-nowrap",a==="rejeitado"?"bg-slate-100 border-slate-200 text-slate-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"),children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-slate-500"}),"Arquivado (",r?"-":t.byStatus.rejeitado,")"]}),e.jsxs("button",{onClick:()=>l("recebido"),className:o("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium border transition-all whitespace-nowrap",a==="recebido"?"bg-blue-100 border-blue-200 text-blue-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"),children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Recebidos (",r?"-":t.byStatus.recebido,")"]}),e.jsxs("button",{onClick:()=>l("resolvido"),className:o("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium border transition-all whitespace-nowrap",a==="resolvido"?"bg-green-100 border-green-200 text-green-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"),children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),"Melhoria concluída (",r?"-":t.byStatus.resolvido,")"]})]}),e.jsx("div",{className:"px-4 mt-4",children:e.jsxs(d,{size:"lg",className:"w-full h-14 text-lg font-semibold shadow-lg shadow-primary/20 rounded-xl flex items-center justify-between px-6 transition-transform active:scale-[0.98]",onClick:w,children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-6 h-6"}),"Nova Observação"]}),e.jsx("div",{className:"bg-white/20 p-1.5 rounded-lg",children:e.jsx(z,{className:"w-5 h-5"})})]})})]}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"font-semibold text-lg flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-primary"}),"Últimas Atualizações"]}),a!=="all"&&e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>l("all"),className:"text-xs h-8 text-muted-foreground hover:text-foreground",children:"Limpar Filtros"})]}),e.jsxs("div",{className:"mb-4 relative",children:[e.jsx(u,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(P,{placeholder:"Buscar por protocolo, bairro ou título...",className:"pl-9 bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800",value:m,onChange:s=>v(s.target.value)})]}),b&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(A,{className:"w-8 h-8 text-primary animate-spin mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando observações..."})]}),!b&&x.length===0&&e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 dark:bg-slate-900 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(u,{className:"w-8 h-8 text-slate-400"})}),e.jsx("h3",{className:"text-base font-medium text-slate-900 dark:text-slate-100",children:"Nenhuma observação encontrada"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Tente mudar os filtros ou faça uma nova observação."})]}),e.jsx("div",{className:"space-y-4",children:x.map(s=>{const n=p[s.status]||p.recebido,C=n.icon;return e.jsx(F.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},whileTap:{scale:.98},onClick:()=>y(s.id),children:e.jsxs(c,{className:"overflow-hidden border-slate-100 dark:border-slate-800 shadow-sm hover:shadow-md transition-shadow cursor-pointer bg-white dark:bg-slate-900",children:[e.jsxs("div",{className:"p-3 flex items-start justify-between border-b border-slate-50 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{icon:s.category?.icon||"mdi:dots-horizontal",color:s.category?.color||"#64748b",size:"sm",withBackground:!0}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:s.category?.name||"Outros"})]}),e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(f,{className:"w-3 h-3"}),I(new Date(s.createdAt),{addSuffix:!0,locale:J})]})]}),e.jsxs("div",{className:"p-3 flex gap-3",children:[s.media&&s.media.length>0&&e.jsx("div",{className:"shrink-0",children:e.jsx("img",{src:s.media[0].thumbUrl||s.media[0].url,alt:"Foto da observação",className:"w-16 h-16 rounded-lg object-cover bg-slate-100 dark:bg-slate-800",loading:"lazy"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-1 line-clamp-2",children:s.title}),s.addressText&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500 mb-2",children:[e.jsx(E,{className:"w-3 h-3 text-slate-400 shrink-0"}),e.jsx("span",{className:"line-clamp-1",children:s.addressText})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(O,{variant:"secondary",className:o("text-[10px] px-2 h-5 font-normal",n.color),children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),n.label]}),e.jsxs("span",{className:"text-[10px] font-mono text-slate-400",children:["#",s.protocol]})]})]})]})]})},s.id)})})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:e.jsx(U,{activeTab:"reportar",onTabChange:k})})]})}export{te as default};
