const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B0hDLWkU.js","assets/vendor-app-D_TKIhWN.js","assets/index-BHa9uMp9.css"])))=>i.map(i=>d[i]);
import{d as s,E as o,_ as h,K as f,L as k}from"./index-B0hDLWkU.js";const c="etijucas_token",i="etijucas_refresh_token";function y(t){const e=t.replace(/\D/g,"");return e.length<=2?e:e.length<=7?`(${e.slice(0,2)}) ${e.slice(2)}`:`(${e.slice(0,2)}) ${e.slice(2,7)}-${e.slice(7,11)}`}function w(t){const e=t.replace(/\D/g,"");return e.length===11&&e[2]==="9"}function g(t){return t.replace(/\D/g,"")}const r={getToken(){return localStorage.getItem(c)},getRefreshToken(){return localStorage.getItem(i)},setTokens(t,e){localStorage.setItem(c,t),localStorage.setItem(i,e),k(t,e)},clearTokens(){localStorage.removeItem(c),localStorage.removeItem(i),f()},isAuthenticated(){return!!this.getToken()}},m={async login(t){const e=await s.post(o.auth.login,t);return e.token&&e.refreshToken&&r.setTokens(e.token,e.refreshToken),e},async sendOtp(t){return await s.post(o.auth.sendOtp,t)},async resendOtp(t){return await s.post(o.auth.resendOtp,t)},async verifyOtp(t){const e=await s.post(o.auth.verifyOtp,t);return e.token&&e.refreshToken&&r.setTokens(e.token,e.refreshToken),e},async register(t){const{useTenantStore:e}=await h(async()=>{const{useTenantStore:u}=await import("./index-B0hDLWkU.js").then(l=>l.O);return{useTenantStore:u}},__vite__mapDeps([0,1,2])),n=e.getState().city?.slug||"tijucas-sc",p={...t,password_confirmation:t.confirmPassword,city_slug:t.citySlug||n},a=await s.post(o.auth.register,p);return r.setTokens(a.token,a.refreshToken),a},async refreshToken(){const t=r.getRefreshToken();if(!t)throw new Error("No refresh token available");const e=await s.post(o.auth.refresh,{refreshToken:t});return r.setTokens(e.token,e.refreshToken),e},async getMe(){return(await s.get(o.auth.me)).data},async logout(){try{await s.post(o.auth.logout)}catch{}finally{r.clearTokens()}},async forgotPassword(t){return await s.post(o.auth.forgotPassword,t)},async resetPassword(t){const e={...t,password_confirmation:t.confirmPassword};return await s.post(o.auth.resetPassword,e)},async requestOtpLogin(t){return await s.post("/auth/otp/login",{phone:g(t)})},async getOtpSession(t){return await s.get(`/auth/otp/session/${t}`)},async verifyOtpLogin(t,e){const n=await s.post("/auth/otp/verify",{sid:t,code:e});return n.token&&n.refreshToken&&r.setTokens(n.token,n.refreshToken),n},async completeProfile(t){return await s.post("/auth/profile/complete",{nome:t.nome,bairro_id:t.bairroId,terms_accepted:t.termsAccepted})},async verifyMagicLink(t){const e=await s.post("/auth/magic-link/verify",{token:t});return e.token&&e.refreshToken&&r.setTokens(e.token,e.refreshToken),e}};export{m as a,g as c,y as f,r as t,w as v};
