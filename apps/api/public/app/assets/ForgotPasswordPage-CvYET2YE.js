import{r as a,j as e,m as c,C as K,a as G,E as W,n as X,b as S,K as _,i as q,A as H,h as J}from"./vendor-app-CFsuVmH9.js";import{v as Q,c as w,a as P}from"./auth.service-BZPOLBHX.js";import{u as U,B as u,c as C}from"./index-DeilxgjZ.js";import{I as k}from"./input-ClxaPzc5.js";import{L as E}from"./label-DFaz3-aU.js";import{C as Y}from"./card-DCECeHj3.js";import{P as Z}from"./PhoneInput-cq6Z3dHS.js";import{O as ee}from"./OTPInput-Cf5eeYcd.js";import"./slider-CN-_Dayh.js";import{P as se,m as A}from"./auth-utils-B5I9WPFS.js";function xe(){const y=U(),[t,n]=a.useState("phone"),[r,R]=a.useState(""),[f,g]=a.useState(""),[O,L]=a.useState(null),[o,D]=a.useState(""),[i,I]=a.useState(""),[l,d]=a.useState(!1),[j,m]=a.useState(null),[x,z]=a.useState(!1),N=Q(w(r)),V=f.length===6,p=se.test(o),h=o===i,v=async(s=!1)=>{if(N){d(!0),m(null);try{const b=await P.forgotPassword({phone:w(r)}),$=new Date(Date.now()+b.expiresIn*1e3);L($),s||n("otp"),s&&g("")}catch(b){m(A(b))}finally{d(!1)}}},F=async()=>{V&&n("password")},T=async()=>{if(!(!p||!h)){d(!0),m(null);try{await P.resetPassword({phone:w(r),code:f,password:o,confirmPassword:i}),n("done")}catch(s){m(A(s))}finally{d(!1)}}},B=async s=>{s.preventDefault(),t==="phone"?await v():t==="otp"?await F():t==="password"&&await T()},M={phone:e.jsxs(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex p-4 rounded-2xl bg-primary/10 mb-4",children:e.jsx(_,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Recuperar Senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Digite seu telefone para receber um código"})]}),e.jsx(Z,{value:r,onChange:R,error:void 0,autoFocus:!0}),e.jsx(u,{type:"submit",size:"lg",disabled:!N||l,className:"w-full h-14 text-lg font-semibold rounded-2xl",children:l?e.jsx(S,{className:"h-5 w-5 animate-spin"}):e.jsxs(e.Fragment,{children:["Enviar Código",e.jsx(q,{className:"h-5 w-5 ml-2"})]})})]},"phone"),otp:e.jsx(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:e.jsx(ee,{value:f,onChange:g,onComplete:s=>{g(s),n("password")},onResend:()=>v(!0),expiresAt:O||void 0,error:j||void 0,isResending:l,isVerifying:!1,phone:`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7)}`})},"otp"),password:e.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex p-4 rounded-2xl bg-primary/10 mb-4",children:e.jsx(G,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Nova Senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Digite sua nova senha"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{type:x?"text":"password",value:o,onChange:s=>D(s.target.value),className:C("h-12 text-base pr-10",o.length>0&&!p&&"border-amber-400"),placeholder:"Mínimo 8 caracteres",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>z(!x),className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground",children:x?e.jsx(W,{className:"h-5 w-5"}):e.jsx(X,{className:"h-5 w-5"})})]}),o.length>0&&!p&&e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:"Mínimo 8 caracteres"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Confirmar Senha"}),e.jsx(k,{type:x?"text":"password",value:i,onChange:s=>I(s.target.value),className:C("h-12 text-base",i.length>0&&!h&&"border-red-400"),placeholder:"Repita a senha",autoComplete:"new-password"}),i.length>0&&!h&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"As senhas não conferem"})]})]}),e.jsx(u,{type:"submit",size:"lg",disabled:!p||!h||l,className:"w-full h-14 text-lg font-semibold rounded-2xl",children:l?e.jsx(S,{className:"h-5 w-5 animate-spin"}):"Redefinir Senha"})]},"password"),done:e.jsxs(c.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex p-6 rounded-full bg-green-100 dark:bg-green-900/30 mb-6",children:e.jsx(K,{className:"h-12 w-12 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Sucesso!"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Sua senha foi redefinida com sucesso."}),e.jsx(u,{size:"lg",onClick:()=>y("/login"),className:"w-full h-14 text-lg font-semibold rounded-2xl bg-green-600 hover:bg-green-700",children:"Fazer Login"})]},"done")};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-primary/5 via-background to-primary/10",children:[e.jsx("div",{className:"p-4",children:t!=="done"&&e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>{t==="phone"?y("/login"):t==="otp"?n("phone"):t==="password"&&n("otp")},className:"rounded-xl",children:e.jsx(H,{className:"h-5 w-5"})})}),e.jsx("div",{className:"flex-1 px-6 flex items-center justify-center pb-20",children:e.jsxs(Y,{className:"w-full max-w-md p-6 shadow-xl border-0 bg-background/80 backdrop-blur-xl",children:[e.jsx("form",{onSubmit:B,children:e.jsx(J,{mode:"wait",children:M[t]})}),j&&e.jsx(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-4 p-3 rounded-xl bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 text-center",children:j})})]})})]})}export{xe as default};
