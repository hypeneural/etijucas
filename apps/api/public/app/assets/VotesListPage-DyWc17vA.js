import{j as e,r as f}from"./vendor-radix-E4gGnxjO.js";import{B as b}from"./button-WIEOpYI-.js";import{f as D,u as A,p as P,d as x,m as R,i as F,X as I,W as z,R as M,l as _,B as q,Q as k}from"./index-BSTgcX-N.js";import{u as T}from"./vendor-query-CeEprVe-.js";import"./sheet-7A4EDfRe.js";import{b as V}from"./votes--jqTh9CK.js";import{B as Y}from"./badge-C76PU-ep.js";import{m as i,A as Q}from"./vendor-motion-R11C44Ho.js";import{T as U}from"./thumbs-up-BI9JuCli.js";import{C as $}from"./clock-BUAXYXQP.js";import{C as H}from"./circle-x-NeVJYeC1.js";import{S as N}from"./search-BwNWK0EF.js";import{v as S}from"./votes.service-BhTDStON.js";import{A as K}from"./arrow-left-Pi1Axqr9.js";import"./vendor-utils-zfZBtJeF.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=D("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);function W({counts:t}){const r=t.sim+t.nao+t.abstencao+t.naoVotou;if(r===0)return null;const c=t.sim/r*100,a=t.nao/r*100,o=(t.abstencao+t.naoVotou)/r*100;return e.jsxs("div",{className:"h-1.5 w-full rounded-full overflow-hidden bg-muted flex",children:[e.jsx(i.div,{initial:{width:0},animate:{width:`${c}%`},transition:{duration:.6,delay:.2},className:"h-full bg-green-500"}),e.jsx(i.div,{initial:{width:0},animate:{width:`${a}%`},transition:{duration:.6,delay:.3},className:"h-full bg-red-500"}),o>0&&e.jsx(i.div,{initial:{width:0},animate:{width:`${o}%`},transition:{duration:.6,delay:.4},className:"h-full bg-gray-300 dark:bg-gray-600"})]})}function X({status:t}){switch(t){case"APROVADO":return e.jsx(F,{className:"w-3.5 h-3.5"});case"REJEITADO":return e.jsx(H,{className:"w-3.5 h-3.5"});case"EM_ANDAMENTO":return e.jsx($,{className:"w-3.5 h-3.5"})}}function G({vote:t,index:r=0}){const c=A(),a=V[t.status],o=d=>new Date(d).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"}),l=()=>{c(`/votacao/${t.id}`)};return e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.05},whileTap:{scale:.98},onClick:l,className:x("bg-card rounded-2xl p-4 border shadow-card","cursor-pointer transition-all duration-200","hover:shadow-md hover:border-border/80","active:shadow-sm"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(P,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:o(t.date)})]}),e.jsxs(Y,{className:x("gap-1 px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider border",a.bgColor,a.textColor,a.borderColor),children:[e.jsx(X,{status:t.status}),a.label]})]}),e.jsx("h3",{className:"text-lg font-bold text-foreground leading-tight mb-1.5 line-clamp-2",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed line-clamp-2 mb-4",children:t.summary}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(U,{className:"w-3 h-3 text-green-600 dark:text-green-400"})}),e.jsx("span",{className:"text-sm font-bold text-green-600 dark:text-green-400",children:t.counts.sim})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-red-100 dark:bg-red-900/30",children:e.jsx(J,{className:"w-3 h-3 text-red-600 dark:text-red-400"})}),e.jsx("span",{className:"text-sm font-bold text-red-600 dark:text-red-400",children:t.counts.nao})]}),(t.counts.abstencao>0||t.counts.naoVotou>0)&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",t.counts.abstencao+t.counts.naoVotou," outros"]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-center gap-1 text-sm font-bold text-foreground",children:[e.jsx("span",{className:"text-green-600",children:t.counts.sim}),e.jsx("span",{className:"text-muted-foreground",children:"×"}),e.jsx("span",{className:"text-red-600",children:t.counts.nao})]})]}),e.jsx(W,{counts:t.counts}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-3 border-t border-border/50",children:[e.jsx("div",{className:"flex gap-1.5 flex-wrap",children:t.tags.slice(0,2).map(d=>e.jsx("span",{className:"px-2 py-0.5 rounded-md bg-muted text-[10px] font-medium text-muted-foreground",children:d},d))}),e.jsxs(b,{variant:"ghost",size:"sm",className:"text-primary font-semibold gap-1 -mr-2",onClick:d=>{d.stopPropagation(),l()},children:["Ver votos",e.jsx(R,{className:"w-4 h-4"})]})]})]})}const Z=[{value:"all",label:"Todos"},{value:"APROVADO",label:"Aprovados"},{value:"REJEITADO",label:"Rejeitados"}];function ee({searchQuery:t,onSearchChange:r,statusFilter:c,onStatusChange:a,yearFilter:o,onYearChange:l,availableYears:d,isSearchOpen:m,onSearchToggle:g,className:h}){return e.jsxs("div",{className:x("space-y-3",h),children:[m&&e.jsxs(i.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",value:t,onChange:s=>r(s.target.value),placeholder:"Buscar por título, número ou tema...",autoFocus:!0,className:x("w-full h-11 pl-10 pr-10 rounded-xl border bg-card","text-sm placeholder:text-muted-foreground","focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary","transition-all duration-200")}),t&&e.jsx("button",{onClick:()=>r(""),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded-full hover:bg-muted transition-colors",children:e.jsx(I,{className:"w-4 h-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 -mx-4 px-4 scrollbar-hide",children:[Z.map(s=>{const j=c===s.value,u=s.value!=="all"?V[s.value]:null;return e.jsx(i.button,{whileTap:{scale:.95},onClick:()=>a(s.value),className:x("flex items-center gap-1.5 px-3 py-2 rounded-full text-sm font-medium whitespace-nowrap","border transition-all duration-200",j?u?x(u.bgColor,u.textColor,u.borderColor):"bg-primary text-primary-foreground border-primary shadow-sm":"bg-card border-border text-muted-foreground hover:bg-muted"),children:s.label},s.value)}),e.jsx("div",{className:"w-px h-8 bg-border shrink-0 self-center"}),e.jsx(i.button,{whileTap:{scale:.95},onClick:()=>l("all"),className:x("px-3 py-2 rounded-full text-sm font-medium whitespace-nowrap","border transition-all duration-200",o==="all"?"bg-primary/10 text-primary border-primary/30":"bg-card border-border text-muted-foreground hover:bg-muted"),children:"Todos Anos"}),d.map(s=>e.jsx(i.button,{whileTap:{scale:.95},onClick:()=>l(s),className:x("px-3 py-2 rounded-full text-sm font-medium whitespace-nowrap","border transition-all duration-200",o===s?"bg-primary/10 text-primary border-primary/30":"bg-card border-border text-muted-foreground hover:bg-muted"),children:s},s))]})]})}function te({type:t,onRetry:r,onClearFilters:c}){const a={"no-results":{icon:N,title:"Nenhuma votação encontrada",description:"Tente ajustar os filtros ou buscar por outro termo.",action:c?{label:"Limpar filtros",onClick:c}:void 0},error:{icon:M,title:"Erro ao carregar",description:"Não foi possível carregar as votações.",action:r?{label:"Tentar novamente",onClick:r}:void 0},offline:{icon:z,title:"Você está offline",description:"Mostrando dados salvos no seu dispositivo.",action:void 0}}[t],o=a.icon;return e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col items-center justify-center py-16 px-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(o,{className:"w-7 h-7 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:a.title}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-[280px] mb-4",children:a.description}),a.action&&e.jsx(i.button,{whileTap:{scale:.95},onClick:a.action.onClick,className:"px-4 py-2 rounded-lg bg-primary text-primary-foreground text-sm font-medium",children:a.action.label})]})}function ae(){return e.jsx("div",{className:"space-y-4 animate-pulse",children:[...Array(4)].map((t,r)=>e.jsxs("div",{className:"bg-card rounded-2xl p-4 border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"h-4 w-20 bg-muted rounded"}),e.jsx("div",{className:"h-5 w-16 bg-muted rounded-full"})]}),e.jsx("div",{className:"h-6 w-3/4 bg-muted rounded mb-2"}),e.jsx("div",{className:"h-4 w-full bg-muted rounded mb-1"}),e.jsx("div",{className:"h-4 w-2/3 bg-muted rounded mb-4"}),e.jsxs("div",{className:"flex gap-4 mb-3",children:[e.jsx("div",{className:"h-6 w-12 bg-muted rounded"}),e.jsx("div",{className:"h-6 w-12 bg-muted rounded"})]}),e.jsx("div",{className:"h-1.5 w-full bg-muted rounded-full"})]},r))})}function ge(){const t=A(),{activeTab:r,setActiveTab:c}=_(),[a,o]=f.useState(""),[l,d]=f.useState("all"),[m,g]=f.useState("all"),[h,s]=f.useState(!1),{data:j,isLoading:u,error:v}=T({queryKey:k.votes.votacoes({status:l!=="all"?l:void 0,ano:m!=="all"?m:void 0,search:a||void 0}),queryFn:()=>S.getAll({status:l!=="all"?l:void 0,ano:m!=="all"?m:void 0,search:a||void 0,perPage:50}),staleTime:5*60*1e3}),{data:E}=T({queryKey:k.votes.anos,queryFn:()=>S.getAnos(),staleTime:60*60*1e3}),y=j?.data||[],B=E||[],p=f.useMemo(()=>y.map(n=>({id:n.id,status:n.status,date:n.data,title:n.titulo,summary:n.subtitulo||"",counts:n.counts,tags:n.tags})),[y]),w=()=>{o(""),d("all"),g("all"),s(!1)},L=n=>{c(n),t("/")},C=a||l!=="all"||m!=="all";return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-muted/50",children:e.jsxs("div",{className:"relative w-full max-w-[420px] h-full bg-background overflow-hidden shadow-elevated",children:[e.jsxs("div",{className:"h-full overflow-y-auto pb-24",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-background/95 backdrop-blur-xl border-b",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 safe-top",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:e.jsx(K,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-lg font-bold",children:"Votações da Câmara"}),e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>s(!h),className:x(h&&"bg-primary/10 text-primary"),children:e.jsx(N,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"sticky top-14 z-30 bg-background/95 backdrop-blur-xl border-b px-4 py-3",children:e.jsx(ee,{searchQuery:a,onSearchChange:o,statusFilter:l,onStatusChange:d,yearFilter:m,onYearChange:g,availableYears:B,isSearchOpen:h,onSearchToggle:()=>s(!h)})}),e.jsxs("main",{className:"px-4 py-5",children:[!u&&p.length>0&&e.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p.length," ",p.length===1?"votação":"votações"]}),C&&e.jsx("button",{onClick:w,className:"text-sm text-primary font-medium",children:"Limpar filtros"})]}),u&&e.jsx(ae,{}),v&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"Erro ao carregar votações"}),e.jsx(b,{variant:"outline",size:"sm",className:"mt-4",onClick:()=>window.location.reload(),children:"Tentar novamente"})]}),!u&&!v&&p.length===0&&e.jsx(te,{type:"no-results",onClearFilters:C?w:void 0}),!u&&!v&&p.length>0&&e.jsx(Q,{mode:"popLayout",children:e.jsx(i.div,{layout:!0,className:"space-y-4 pb-8",children:p.map((n,O)=>e.jsx(G,{vote:n,index:O},n.id))})})]})]}),e.jsx(q,{activeTab:r,onTabChange:L})]})})}export{ge as default};
