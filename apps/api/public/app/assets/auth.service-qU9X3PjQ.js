import{a as s,E as n,c as i,s as p}from"./client-w4Cmw8pS.js";const a="etijucas_token",c="etijucas_refresh_token";function h(t){const e=t.replace(/\D/g,"");return e.length<=2?e:e.length<=7?`(${e.slice(0,2)}) ${e.slice(2)}`:`(${e.slice(0,2)}) ${e.slice(2,7)}-${e.slice(7,11)}`}function f(t){const e=t.replace(/\D/g,"");return e.length===11&&e[2]==="9"}function l(t){return t.replace(/\D/g,"")}const r={getToken(){return localStorage.getItem(a)},getRefreshToken(){return localStorage.getItem(c)},setTokens(t,e){localStorage.setItem(a,t),localStorage.setItem(c,e),p(t,e)},clearTokens(){localStorage.removeItem(a),localStorage.removeItem(c),i()},isAuthenticated(){return!!this.getToken()}},k={async login(t){const e=await s.post(n.auth.login,t);return e.token&&e.refreshToken&&r.setTokens(e.token,e.refreshToken),e},async sendOtp(t){return await s.post(n.auth.sendOtp,t)},async resendOtp(t){return await s.post(n.auth.resendOtp,t)},async verifyOtp(t){const e=await s.post(n.auth.verifyOtp,t);return e.token&&e.refreshToken&&r.setTokens(e.token,e.refreshToken),e},async register(t){const e={...t,password_confirmation:t.confirmPassword},o=await s.post(n.auth.register,e);return r.setTokens(o.token,o.refreshToken),o},async refreshToken(){const t=r.getRefreshToken();if(!t)throw new Error("No refresh token available");const e=await s.post(n.auth.refresh,{refreshToken:t});return r.setTokens(e.token,e.refreshToken),e},async getMe(){return(await s.get(n.auth.me)).data},async logout(){try{await s.post(n.auth.logout)}catch{}finally{r.clearTokens()}},async forgotPassword(t){return await s.post(n.auth.forgotPassword,t)},async resetPassword(t){const e={...t,password_confirmation:t.confirmPassword};return await s.post(n.auth.resetPassword,e)},async requestOtpLogin(t){return await s.post("/auth/otp/login",{phone:l(t)})},async getOtpSession(t){return await s.get(`/auth/otp/session/${t}`)},async verifyOtpLogin(t,e){const o=await s.post("/auth/otp/verify",{sid:t,code:e});return o.token&&o.refreshToken&&r.setTokens(o.token,o.refreshToken),o},async completeProfile(t){return await s.post("/auth/profile/complete",{nome:t.nome,bairro_id:t.bairroId,terms_accepted:t.termsAccepted})}};export{k as a,l as c,h as f,r as t,f as v};
