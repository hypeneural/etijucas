import{a as n,E as s}from"./client-BdVdTjkU.js";import{r as p,s as g}from"./localDatabase-LdCBzyem.js";import{j as c}from"./vendor-app-DpJht6ER.js";import{I as u}from"./iconify-C8dm1vD2.js";import{c as i}from"./index-Bhp1RHVo.js";async function m(){try{return(await n.get(s.reports.categories)).data}catch(e){throw console.error("[ReportService] Failed to fetch categories:",e),e}}async function f(e,r){const t=new FormData;t.append("categoryId",e.categoryId),t.append("title",e.title),t.append("description",e.description),e.addressText&&t.append("addressText",e.addressText),e.addressSource&&t.append("addressSource",e.addressSource),e.locationQuality&&t.append("locationQuality",e.locationQuality),e.latitude!==void 0&&t.append("latitude",String(e.latitude)),e.longitude!==void 0&&t.append("longitude",String(e.longitude)),e.locationAccuracyM!==void 0&&t.append("locationAccuracyM",String(e.locationAccuracyM)),e.bairroId&&t.append("bairroId",e.bairroId),e.images&&e.images.length>0&&e.images.forEach(a=>{t.append("images[]",a)});try{const a=await n.postFormData(s.reports.create,t,{headers:{"X-Idempotency-Key":r}});if(a.data)try{await p.save(a.data)}catch(o){console.warn("[ReportService] Failed to cache report to IndexedDB:",o)}return a.data}catch(a){throw console.error("[ReportService] Failed to create report:",a),await g.exists(r)||await g.add({type:"report",data:{...e,images:[]},idempotencyKey:r}),a}}async function S(e){try{const r=new URLSearchParams;e?.status&&r.append("status",e.status),e?.categoryId&&r.append("categoryId",e.categoryId),e?.page&&r.append("page",String(e.page)),e?.perPage&&r.append("perPage",String(e.perPage));const t=r.toString(),a=t?`${s.reports.myReports}?${t}`:s.reports.myReports,o=await n.get(a);if(o.data.length>0)try{await p.saveMany(o.data)}catch(d){console.warn("[ReportService] Failed to cache reports to IndexedDB:",d)}return o}catch(r){console.error("[ReportService] Failed to fetch my reports:",r);const t=await p.getAll();return{data:t,meta:{current_page:1,last_page:1,per_page:10,total:t.length}}}}async function w(e){try{const r=new URLSearchParams;e?.status&&r.append("status",e.status),e?.categoryId&&r.append("categoryId",e.categoryId),e?.search&&r.append("search",e.search),e?.page&&r.append("page",String(e.page)),e?.perPage&&r.append("perPage",String(e.perPage));const t=r.toString(),a=t?`${s.reports.list}?${t}`:s.reports.list;return await n.get(a)}catch(r){throw console.error("[ReportService] Failed to fetch public reports:",r),r}}async function x(){try{return(await n.get(s.reports.stats)).data}catch(e){return console.error("[ReportService] Failed to fetch reports stats:",e),{total:0,byStatus:{recebido:0,em_analise:0,resolvido:0,rejeitado:0},thisMonth:0,resolvedThisMonth:0}}}async function y(e){try{const r=await n.get(s.reports.get(e));try{await p.save(r.data)}catch(t){console.warn("[ReportService] Failed to cache report to IndexedDB:",t)}return r.data}catch(r){return console.error("[ReportService] Failed to fetch report:",r),await p.getById(e)}}async function v(e,r){const t=new FormData;return r.forEach(o=>{t.append("images[]",o)}),(await n.postFormData(s.reports.addMedia(e),t)).data}async function R(e,r){await n.delete(s.reports.removeMedia(e,r))}async function I(e,r,t){try{const a=new URLSearchParams({q:e});return r!==void 0&&a.append("lat",String(r)),t!==void 0&&a.append("lon",String(t)),(await n.get(`${s.geocode.autocomplete}?${a.toString()}`)).data}catch(a){return console.error("[ReportService] Geocode autocomplete failed:",a),[]}}async function F(e,r){try{const t=new URLSearchParams({lat:String(e),lon:String(r)});return(await n.get(`${s.geocode.reverse}?${t.toString()}`)).data}catch(t){return console.error("[ReportService] Geocode reverse failed:",t),null}}const $={getCategories:m,createReport:f,getMyReports:S,getPublicReports:w,getReportsStats:x,getReportById:y,addReportMedia:v,removeReportMedia:R,geocodeAutocomplete:I,geocodeReverse:F},l={sm:"w-5 h-5",md:"w-8 h-8",lg:"w-10 h-10",xl:"w-12 h-12"},h={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-14 h-14",xl:"w-16 h-16"};function C({icon:e,color:r="#6b7280",size:t="md",className:a,withBackground:o=!1}){return e.includes(":")?o?c.jsx("div",{className:i("rounded-xl flex items-center justify-center",h[t],a),style:{backgroundColor:`${r}20`},children:c.jsx(u,{icon:e,className:l[t],style:{color:r}})}):c.jsx(u,{icon:e,className:i(l[t],a),style:{color:r}}):o?c.jsx("div",{className:i("rounded-xl flex items-center justify-center",h[t],a),style:{backgroundColor:`${r}20`},children:c.jsx("span",{className:i("text-center",t==="sm"?"text-lg":t==="md"?"text-2xl":"text-3xl"),children:e})}):c.jsx("span",{className:i("text-center",t==="sm"?"text-lg":t==="md"?"text-2xl":"text-3xl",a),children:e})}export{C,$ as r};
