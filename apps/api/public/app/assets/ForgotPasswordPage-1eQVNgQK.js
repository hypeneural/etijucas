import{r as a,j as e}from"./vendor-radix-CQkmBfGK.js";import{B as u}from"./button-CaZ-p8Gx.js";import{I as S}from"./input-BOuGYii1.js";import{L as P}from"./label-CiX9QtKj.js";import{C as K}from"./card-Bx70r8zN.js";import{P as G}from"./PhoneInput-DPPQTJiw.js";import{O as W,K as X,A as _}from"./OTPInput-DgEk8F13.js";import{u as q,v as H,c as w,i as J,d as C,b as k,e as A}from"./index-C2s0NZTP.js";import"./slider-DN_e0EiW.js";import{P as Q,m as E}from"./auth-utils-BBv7SnUt.js";import{m as c,A as U}from"./vendor-motion-3m9Rluu3.js";import{L as Y}from"./lock-BLGwhqEQ.js";import{E as Z,a as ee}from"./eye-06TjQbTj.js";import{A as se}from"./arrow-left-D6o8ZULV.js";import"./vendor-utils-YRYEdvK0.js";import"./phone-CMkdEa08.js";import"./circle-alert-CvxyilxV.js";import"./message-circle-Db3GgEC-.js";import"./smartphone-xYjJYY_d.js";import"./sparkles-CoPjwEEz.js";import"./vendor-query-BnSlUk-m.js";function ve(){const y=q(),[t,o]=a.useState("phone"),[r,R]=a.useState(""),[f,g]=a.useState(""),[L,O]=a.useState(null),[i,D]=a.useState(""),[n,I]=a.useState(""),[l,d]=a.useState(!1),[j,m]=a.useState(null),[p,z]=a.useState(!1),N=H(w(r)),V=f.length===6,x=Q.test(i),h=i===n,v=async(s=!1)=>{if(N){d(!0),m(null);try{const b=await A.forgotPassword({phone:w(r)}),$=new Date(Date.now()+b.expiresIn*1e3);O($),s||o("otp"),s&&g("")}catch(b){m(E(b))}finally{d(!1)}}},F=async()=>{V&&o("password")},B=async()=>{if(!(!x||!h)){d(!0),m(null);try{await A.resetPassword({phone:w(r),code:f,password:i,confirmPassword:n}),o("done")}catch(s){m(E(s))}finally{d(!1)}}},M=async s=>{s.preventDefault(),t==="phone"?await v():t==="otp"?await F():t==="password"&&await B()},T={phone:e.jsxs(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex p-4 rounded-2xl bg-primary/10 mb-4",children:e.jsx(X,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Recuperar Senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Digite seu telefone para receber um código"})]}),e.jsx(G,{value:r,onChange:R,error:void 0,autoFocus:!0}),e.jsx(u,{type:"submit",size:"lg",disabled:!N||l,className:"w-full h-14 text-lg font-semibold rounded-2xl",children:l?e.jsx(k,{className:"h-5 w-5 animate-spin"}):e.jsxs(e.Fragment,{children:["Enviar Código",e.jsx(_,{className:"h-5 w-5 ml-2"})]})})]},"phone"),otp:e.jsx(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:e.jsx(W,{value:f,onChange:g,onComplete:s=>{g(s),o("password")},onResend:()=>v(!0),expiresAt:L||void 0,error:j||void 0,isResending:l,isVerifying:!1,phone:`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7)}`})},"otp"),password:e.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex p-4 rounded-2xl bg-primary/10 mb-4",children:e.jsx(Y,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Nova Senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Digite sua nova senha"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{type:p?"text":"password",value:i,onChange:s=>D(s.target.value),className:C("h-12 text-base pr-10",i.length>0&&!x&&"border-amber-400"),placeholder:"Mínimo 8 caracteres",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>z(!p),className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground",children:p?e.jsx(Z,{className:"h-5 w-5"}):e.jsx(ee,{className:"h-5 w-5"})})]}),i.length>0&&!x&&e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:"Mínimo 8 caracteres"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Confirmar Senha"}),e.jsx(S,{type:p?"text":"password",value:n,onChange:s=>I(s.target.value),className:C("h-12 text-base",n.length>0&&!h&&"border-red-400"),placeholder:"Repita a senha",autoComplete:"new-password"}),n.length>0&&!h&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"As senhas não conferem"})]})]}),e.jsx(u,{type:"submit",size:"lg",disabled:!x||!h||l,className:"w-full h-14 text-lg font-semibold rounded-2xl",children:l?e.jsx(k,{className:"h-5 w-5 animate-spin"}):"Redefinir Senha"})]},"password"),done:e.jsxs(c.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex p-6 rounded-full bg-green-100 dark:bg-green-900/30 mb-6",children:e.jsx(J,{className:"h-12 w-12 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Sucesso!"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Sua senha foi redefinida com sucesso."}),e.jsx(u,{size:"lg",onClick:()=>y("/login"),className:"w-full h-14 text-lg font-semibold rounded-2xl bg-green-600 hover:bg-green-700",children:"Fazer Login"})]},"done")};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-primary/5 via-background to-primary/10",children:[e.jsx("div",{className:"p-4",children:t!=="done"&&e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>{t==="phone"?y("/login"):t==="otp"?o("phone"):t==="password"&&o("otp")},className:"rounded-xl",children:e.jsx(se,{className:"h-5 w-5"})})}),e.jsx("div",{className:"flex-1 px-6 flex items-center justify-center pb-20",children:e.jsxs(K,{className:"w-full max-w-md p-6 shadow-xl border-0 bg-background/80 backdrop-blur-xl",children:[e.jsx("form",{onSubmit:M,children:e.jsx(U,{mode:"wait",children:T[t]})}),j&&e.jsx(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-4 p-3 rounded-xl bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 text-center",children:j})})]})})]})}export{ve as default};
