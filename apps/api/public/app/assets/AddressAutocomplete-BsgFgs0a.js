import{b,c as k,H as A}from"./index-BUop3U7T.js";import{r as i,j as e}from"./vendor-radix-BOMdSbHx.js";import{I as l}from"./input-DlWuI3c2.js";import{L as n}from"./label-DiE7VDBG.js";import{M as L}from"./map-pin-x09jto2J.js";import{A as C,m}from"./vendor-motion-DqUnpu2Q.js";import{L as S}from"./loader-circle-DigY41PY.js";import{C as B}from"./check-CVwATSQd.js";import{C as E}from"./circle-alert-BKbSYziG.js";import{B as I}from"./building-2-D8Sp03Ig.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=b("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),M="https://viacep.com.br/ws";function v(a){const t=a.replace(/\D/g,"");return/^\d{8}$/.test(t)}function $(a){const t=a.replace(/\D/g,"");return t.length<=5?t:`${t.slice(0,5)}-${t.slice(5,8)}`}function j(a){return a.replace(/\D/g,"")}const D={async fetchByCEP(a){const t=j(a);if(!v(t))throw new Error("CEP inválido. O CEP deve ter 8 dígitos.");try{const o=await fetch(`${M}/${t}/json/`);if(!o.ok)throw o.status===400?new Error("Formato de CEP inválido."):new Error("Erro ao consultar o CEP. Tente novamente.");const c=await o.json();if(c.erro)throw new Error("CEP não encontrado. Verifique e tente novamente.");return c}catch(o){throw o instanceof Error?o:new Error("Erro de conexão ao consultar o CEP.")}}};function J({value:a,onChange:t,error:o,disabled:c=!1}){const[g,w]=i.useState(a.cep||""),[p,y]=i.useState(!1),[x,h]=i.useState(null),[N,f]=i.useState(!1),P=i.useCallback(s=>{const u=s.target.value,r=j(u);r.length<=8&&(w($(r)),h(null),f(!1),t({...a,cep:r}))},[t,a]);i.useEffect(()=>{const s=j(g);s.length===8&&v(s)&&(async()=>{y(!0),h(null),f(!1);try{const r=await D.fetchByCEP(s);if(r.localidade?.toLowerCase()!=="tijucas"){h("Somente moradores de Tijucas podem se cadastrar. Este CEP é de "+r.localidade+"."),t({cep:s});return}t({cep:s,logradouro:r.logradouro,bairro:r.bairro,localidade:"Tijucas",uf:"SC",complemento:r.complemento||void 0}),f(!0)}catch(r){h(r instanceof Error?r.message:"Erro ao buscar CEP"),t({cep:s})}finally{y(!1)}})()},[g]);const d=i.useCallback((s,u)=>{t({...a,[s]:u})},[t,a]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"CEP"]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:"text",inputMode:"numeric",placeholder:"00000-000",value:g,onChange:P,disabled:c||p,className:k("h-12 text-base pr-12",x&&"border-red-400",N&&"border-green-400")}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsxs(C,{mode:"wait",children:[p&&e.jsx(m.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:e.jsx(S,{className:"h-5 w-5 animate-spin text-primary"})},"loading"),N&&!p&&e.jsx(m.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"p-1 rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(B,{className:"h-4 w-4 text-green-600 dark:text-green-400"})},"success"),x&&!p&&e.jsx(m.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"p-1 rounded-full bg-red-100 dark:bg-red-900/30",children:e.jsx(E,{className:"h-4 w-4 text-red-600 dark:text-red-400"})},"error")]})})]}),x&&e.jsx(m.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"text-sm text-red-500",children:x}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Digite o CEP para preencher automaticamente"}),!a.logradouro&&e.jsx("button",{type:"button",onClick:()=>{t({...a,logradouro:" ",bairro:"",localidade:"",uf:""})},className:"text-xs text-primary hover:underline",children:"Não sei o CEP"})]})]}),e.jsx(C,{children:a.logradouro&&e.jsxs(m.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Rua"]}),e.jsx(l,{type:"text",value:a.logradouro||"",onChange:s=>d("logradouro",s.target.value),disabled:c,className:"h-12 bg-muted/30"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Número"}),e.jsx(l,{type:"text",placeholder:"123",value:a.numero||"",onChange:s=>d("numero",s.target.value),disabled:c,className:"h-12"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Complemento"}),e.jsx(l,{type:"text",placeholder:"Apto, Bloco...",value:a.complemento||"",onChange:s=>d("complemento",s.target.value),disabled:c,className:"h-12"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Bairro"}),e.jsx(l,{type:"text",value:a.bairro||"",onChange:s=>d("bairro",s.target.value),disabled:c,className:"h-12 bg-muted/30"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Cidade"]}),e.jsx(l,{type:"text",value:a.localidade||"",onChange:s=>d("localidade",s.target.value),disabled:c,className:"h-12 bg-muted/30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"UF"}),e.jsx(l,{type:"text",value:a.uf||"",onChange:s=>d("uf",s.target.value),disabled:c,maxLength:2,className:"h-12 bg-muted/30 text-center uppercase"})]})]})]})}),o&&e.jsxs(m.p,{initial:{opacity:0},animate:{opacity:1},className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(E,{className:"h-4 w-4"}),o]})]})}export{J as A,G as M};
