import{r as a,j as e}from"./vendor-radix-i3jPA7eY.js";import{B as u}from"./button-D3U3fieT.js";import{I as S}from"./input-Cb8a3c-T.js";import{v as K,c as w,a as G,L as P,b as C}from"./label-SpJJWOi8.js";import{C as W}from"./card-D8zF_uJ0.js";import{P as X}from"./PhoneInput-BlZkrD7G.js";import{O as _,K as q,A as H}from"./OTPInput-ZGJZcKIF.js";import{u as J,C as Q,c as k}from"./index-C3c9aPer.js";import"./slider-Cg5wJtx2.js";import{P as U,m as A}from"./auth-utils-DRj4CppN.js";import{m as c,A as Y}from"./vendor-motion-CFwwOuCD.js";import{E as Z,a as ee}from"./eye-BpVoonkj.js";import{L as E}from"./loader-circle-DrfLo_0E.js";import{A as se}from"./arrow-left-C4Ll0_sP.js";import"./vendor-utils-DycLLelI.js";import"./client-CmUA6yYr.js";import"./phone-j7IVnka_.js";import"./check-pWxgpWy-.js";import"./circle-alert-CZ2qqqXu.js";import"./message-circle-UgsMw6Xk.js";import"./smartphone-CjvnYRN8.js";import"./sparkles-DxfIk5gt.js";import"./vendor-query-1wfeA5IL.js";function Pe(){const y=J(),[t,o]=a.useState("phone"),[r,R]=a.useState(""),[f,g]=a.useState(""),[L,O]=a.useState(null),[i,D]=a.useState(""),[n,I]=a.useState(""),[l,d]=a.useState(!1),[j,m]=a.useState(null),[p,z]=a.useState(!1),N=K(w(r)),V=f.length===6,x=U.test(i),h=i===n,v=async(s=!1)=>{if(N){d(!0),m(null);try{const b=await C.forgotPassword({phone:w(r)}),$=new Date(Date.now()+b.expiresIn*1e3);O($),s||o("otp"),s&&g("")}catch(b){m(A(b))}finally{d(!1)}}},F=async()=>{V&&o("password")},B=async()=>{if(!(!x||!h)){d(!0),m(null);try{await C.resetPassword({phone:w(r),code:f,password:i,confirmPassword:n}),o("done")}catch(s){m(A(s))}finally{d(!1)}}},M=async s=>{s.preventDefault(),t==="phone"?await v():t==="otp"?await F():t==="password"&&await B()},T={phone:e.jsxs(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex p-4 rounded-2xl bg-primary/10 mb-4",children:e.jsx(q,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Recuperar Senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Digite seu telefone para receber um código"})]}),e.jsx(X,{value:r,onChange:R,error:void 0,autoFocus:!0}),e.jsx(u,{type:"submit",size:"lg",disabled:!N||l,className:"w-full h-14 text-lg font-semibold rounded-2xl",children:l?e.jsx(E,{className:"h-5 w-5 animate-spin"}):e.jsxs(e.Fragment,{children:["Enviar Código",e.jsx(H,{className:"h-5 w-5 ml-2"})]})})]},"phone"),otp:e.jsx(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:e.jsx(_,{value:f,onChange:g,onComplete:s=>{g(s),o("password")},onResend:()=>v(!0),expiresAt:L||void 0,error:j||void 0,isResending:l,isVerifying:!1,phone:`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7)}`})},"otp"),password:e.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex p-4 rounded-2xl bg-primary/10 mb-4",children:e.jsx(G,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Nova Senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Digite sua nova senha"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{type:p?"text":"password",value:i,onChange:s=>D(s.target.value),className:k("h-12 text-base pr-10",i.length>0&&!x&&"border-amber-400"),placeholder:"Mínimo 8 caracteres",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>z(!p),className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground",children:p?e.jsx(Z,{className:"h-5 w-5"}):e.jsx(ee,{className:"h-5 w-5"})})]}),i.length>0&&!x&&e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:"Mínimo 8 caracteres"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Confirmar Senha"}),e.jsx(S,{type:p?"text":"password",value:n,onChange:s=>I(s.target.value),className:k("h-12 text-base",n.length>0&&!h&&"border-red-400"),placeholder:"Repita a senha",autoComplete:"new-password"}),n.length>0&&!h&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"As senhas não conferem"})]})]}),e.jsx(u,{type:"submit",size:"lg",disabled:!x||!h||l,className:"w-full h-14 text-lg font-semibold rounded-2xl",children:l?e.jsx(E,{className:"h-5 w-5 animate-spin"}):"Redefinir Senha"})]},"password"),done:e.jsxs(c.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex p-6 rounded-full bg-green-100 dark:bg-green-900/30 mb-6",children:e.jsx(Q,{className:"h-12 w-12 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Sucesso!"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Sua senha foi redefinida com sucesso."}),e.jsx(u,{size:"lg",onClick:()=>y("/login"),className:"w-full h-14 text-lg font-semibold rounded-2xl bg-green-600 hover:bg-green-700",children:"Fazer Login"})]},"done")};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-primary/5 via-background to-primary/10",children:[e.jsx("div",{className:"p-4",children:t!=="done"&&e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>{t==="phone"?y("/login"):t==="otp"?o("phone"):t==="password"&&o("otp")},className:"rounded-xl",children:e.jsx(se,{className:"h-5 w-5"})})}),e.jsx("div",{className:"flex-1 px-6 flex items-center justify-center pb-20",children:e.jsxs(W,{className:"w-full max-w-md p-6 shadow-xl border-0 bg-background/80 backdrop-blur-xl",children:[e.jsx("form",{onSubmit:M,children:e.jsx(Y,{mode:"wait",children:T[t]})}),j&&e.jsx(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-4 p-3 rounded-xl bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 text-center",children:j})})]})})]})}export{Pe as default};
