import{a as t,E as n,c as i,s as p}from"./client-BdVdTjkU.js";const a="etijucas_token",c="etijucas_refresh_token";function h(s){const e=s.replace(/\D/g,"");return e.length<=2?e:e.length<=7?`(${e.slice(0,2)}) ${e.slice(2)}`:`(${e.slice(0,2)}) ${e.slice(2,7)}-${e.slice(7,11)}`}function f(s){const e=s.replace(/\D/g,"");return e.length===11&&e[2]==="9"}function u(s){return s.replace(/\D/g,"")}const r={getToken(){return localStorage.getItem(a)},getRefreshToken(){return localStorage.getItem(c)},setTokens(s,e){localStorage.setItem(a,s),localStorage.setItem(c,e),p(s,e)},clearTokens(){localStorage.removeItem(a),localStorage.removeItem(c),i()},isAuthenticated(){return!!this.getToken()}},g={async login(s){const e=await t.post(n.auth.login,s);return e.token&&e.refreshToken&&r.setTokens(e.token,e.refreshToken),e},async sendOtp(s){return await t.post(n.auth.sendOtp,s)},async resendOtp(s){return await t.post(n.auth.resendOtp,s)},async verifyOtp(s){const e=await t.post(n.auth.verifyOtp,s);return e.token&&e.refreshToken&&r.setTokens(e.token,e.refreshToken),e},async register(s){const e={...s,password_confirmation:s.confirmPassword,city_slug:"tijucas-sc"},o=await t.post(n.auth.register,e);return r.setTokens(o.token,o.refreshToken),o},async refreshToken(){const s=r.getRefreshToken();if(!s)throw new Error("No refresh token available");const e=await t.post(n.auth.refresh,{refreshToken:s});return r.setTokens(e.token,e.refreshToken),e},async getMe(){return(await t.get(n.auth.me)).data},async logout(){try{await t.post(n.auth.logout)}catch{}finally{r.clearTokens()}},async forgotPassword(s){return await t.post(n.auth.forgotPassword,s)},async resetPassword(s){const e={...s,password_confirmation:s.confirmPassword};return await t.post(n.auth.resetPassword,e)},async requestOtpLogin(s){return await t.post("/auth/otp/login",{phone:u(s)})},async getOtpSession(s){return await t.get(`/auth/otp/session/${s}`)},async verifyOtpLogin(s,e){const o=await t.post("/auth/otp/verify",{sid:s,code:e});return o.token&&o.refreshToken&&r.setTokens(o.token,o.refreshToken),o},async completeProfile(s){return await t.post("/auth/profile/complete",{nome:s.nome,bairro_id:s.bairroId,terms_accepted:s.termsAccepted})}};export{g as a,u as c,h as f,r as t,f as v};
