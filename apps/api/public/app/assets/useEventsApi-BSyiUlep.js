import{f as D,x as u,k as r,E as n}from"./index-a72PoV5F.js";import{u as v}from"./vendor-query-BnSlUk-m.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=D("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);function y(e){const t={};return e.page&&(t.page=e.page),e.perPage&&(t.perPage=e.perPage),e.search&&(t.search=e.search),e.categoryId&&(t.categoryId=e.categoryId),e.category&&(t.category=e.category),e.bairroId&&(t.bairroId=e.bairroId),e.venueId&&(t.venueId=e.venueId),e.organizerId&&(t.organizerId=e.organizerId),e.tags&&(t.tags=e.tags),e.fromDate&&(t.fromDate=e.fromDate),e.toDate&&(t.toDate=e.toDate),e.datePreset&&(t.datePreset=e.datePreset),e.price&&(t.price=e.price),e.priceMin!==void 0&&(t.priceMin=e.priceMin),e.priceMax!==void 0&&(t.priceMax=e.priceMax),e.timeOfDay&&(t.timeOfDay=e.timeOfDay),e.ageRating&&(t.ageRating=e.ageRating),e.accessibility&&(t.accessibility=e.accessibility),e.parking&&(t.parking=e.parking),e.outdoor&&(t.outdoor=e.outdoor),e.kids&&(t.kids=e.kids),e.featured&&(t.featured=e.featured),e.orderBy&&(t.orderBy=e.orderBy),e.order&&(t.order=e.order),t}const h={async getAll(e={}){try{const t=await r.get(n.events.list,y(e));return t.data&&t.data.length>0&&await this.cacheEvents(t.data),t}catch(t){return console.warn("[EventService] API failed, using cache:",t),this.getFromCache(e)}},async getUpcoming(e=10){try{const t=await r.get(n.events.upcoming,{perPage:e});return t.data&&t.data.length>0&&await this.cacheEvents(t.data),t}catch(t){return console.warn("[EventService] API failed for upcoming:",t),this.getFromCache({orderBy:"startDateTime",order:"asc"})}},async getToday(){try{const e=await r.get(n.events.today);return e.data&&e.data.length>0&&await this.cacheEvents(e.data),e}catch(e){return console.warn("[EventService] API failed for today:",e),this.getFromCache({datePreset:"today"})}},async getWeekend(){try{const e=await r.get(n.events.weekend);return e.data&&e.data.length>0&&await this.cacheEvents(e.data),e}catch(e){return console.warn("[EventService] API failed for weekend:",e),this.getFromCache({datePreset:"weekend"})}},async getFeatured(e=6){try{const t=await r.get(n.events.featured,{perPage:e});return t.data&&t.data.length>0&&await this.cacheEvents(t.data),t}catch(t){return console.warn("[EventService] API failed for featured:",t),this.getFromCache({featured:!0})}},async search(e,t={}){try{return await r.get(n.events.search,{q:e,...y(t)})}catch(a){return console.warn("[EventService] API failed for search:",a),this.getFromCache({search:e,...t})}},async getHomeFeatured(){try{const e=await r.get(n.events.homeFeatured);if(e.data){const t=[...e.data.highlight?[e.data.highlight]:[],...e.data.today,...e.data.weekend,...e.data.upcoming];for(const a of t){const s={id:a.id,titulo:a.title,dateTime:new Date(a.startDateTime),local:a.venue?.name||"",bairroId:a.venue?.bairro||"",tags:[],imageUrl:a.coverImage||void 0};await u.save(s)}}return e}catch(e){console.warn("[EventService] API failed for homeFeatured:",e);const t=await u.getAll(),a=new Date,s=new Date(a.getFullYear(),a.getMonth(),a.getDate()),l=new Date(s);l.setDate(l.getDate()+1);const g=new Date(s);g.setDate(s.getDate()+(6-s.getDay()));const i=new Date(g);i.setDate(g.getDate()+1);const d=c=>({id:c.id,title:c.titulo||"",slug:c.id,coverImage:c.imageUrl||null,startDateTime:c.dateTime instanceof Date?c.dateTime.toISOString():String(c.dateTime),venue:{name:c.local},ticket:null,category:null});return{data:{highlight:t[0]?{...d(t[0]),bannerImage:null,badge:null}:null,today:t.filter(c=>{const f=c.dateTime instanceof Date?c.dateTime:new Date(String(c.dateTime));return f>=s&&f<l}).slice(0,5).map(d),weekend:t.filter(c=>{const f=c.dateTime instanceof Date?c.dateTime:new Date(String(c.dateTime));return f>=g&&f<=i}).slice(0,5).map(d),upcoming:t.slice(0,10).map(d)},success:!0}}},async getCalendarSummary(e,t){try{return await r.get(n.events.calendarSummary,{year:e,month:t})}catch(a){console.warn("[EventService] API failed for calendarSummary:",a);const s=await u.getAll(),l={};let g=0;return s.forEach(i=>{const c=(i.dateTime instanceof Date?i.dateTime.toISOString():String(i.dateTime)).substring(0,10);if(!c)return;const[f,m]=c.split("-").map(Number);f===e&&m===t&&(l[c]||(l[c]={count:0,hasHighlight:!1}),l[c].count++,i.isFeatured&&(l[c].hasHighlight=!0),g++)}),{data:l,meta:{year:e,month:t,totalEvents:g},success:!0}}},async getByDate(e){try{const t=await r.get(n.events.byDate(e));return t.data&&t.data.length>0&&await this.cacheEvents(t.data),t}catch(t){return console.warn("[EventService] API failed for byDate:",t),this.getFromCache({fromDate:e,toDate:e})}},async getByMonth(e,t){try{const a=await r.get(n.events.byMonth(e,t),{perPage:100});return a.data&&a.data.length>0&&await this.cacheEvents(a.data),a}catch(a){console.warn("[EventService] API failed for byMonth:",a);const s=`${e}-${String(t).padStart(2,"0")}-01`,l=`${e}-${String(t).padStart(2,"0")}-${new Date(e,t,0).getDate()}`;return this.getFromCache({fromDate:s,toDate:l})}},async getByCategory(e,t={}){try{const a=await r.get(n.events.byCategory(e),y(t));return a.data&&a.data.length>0&&await this.cacheEvents(a.data),a}catch(a){return console.warn("[EventService] API failed for byCategory:",a),this.getFromCache({category:e,...t})}},async getByBairro(e,t={}){try{const a=await r.get(n.events.byBairro(e),y(t));return a.data&&a.data.length>0&&await this.cacheEvents(a.data),a}catch(a){return console.warn("[EventService] API failed for byBairro:",a),this.getFromCache({bairroId:e,...t})}},async getByVenue(e,t={}){try{return await r.get(n.events.byVenue(e),y(t))}catch(a){return console.warn("[EventService] API failed for byVenue:",a),this.getFromCache({venueId:e,...t})}},async getByTag(e,t={}){try{return await r.get(n.events.byTag(e),y(t))}catch(a){return console.warn("[EventService] API failed for byTag:",a),this.getFromCache({tags:e,...t})}},async getByOrganizer(e,t={}){try{return await r.get(n.events.byOrganizer(e),y(t))}catch(a){return console.warn("[EventService] API failed for byOrganizer:",a),this.getFromCache({organizerId:e,...t})}},async getById(e){try{const t=await r.get(n.events.get(e));return t.data&&await this.cacheEvent(t.data),t}catch(t){console.warn("[EventService] API failed for getById:",t);const a=await u.getById(e);if(a)return{data:a,success:!0};throw t}},async getCategories(){try{return await r.get(n.events.categories)}catch(e){return console.warn("[EventService] API failed for categories:",e),{data:this.getDefaultCategories(),success:!0}}},async getTags(){try{return await r.get(n.events.tags)}catch(e){return console.warn("[EventService] API failed for tags:",e),{data:this.getDefaultTags(),success:!0}}},async getTrendingTags(){try{return await r.get(n.events.tagsTrending)}catch(e){return console.warn("[EventService] API failed for trending tags:",e),{data:this.getDefaultTags().filter(t=>t.isFeatured),success:!0}}},async getRsvp(e){try{return await r.get(n.events.rsvp(e))}catch(t){return console.warn("[EventService] API failed for getRsvp:",t),null}},async createRsvp(e,t){return r.post(n.events.rsvp(e),t)},async updateRsvp(e,t){return r.put(n.events.rsvp(e),t)},async deleteRsvp(e){return r.delete(n.events.rsvp(e))},async getAttendees(e,t=1,a=20){return r.get(n.events.attendees(e),{page:t,perPage:a})},async toggleFavorite(e){return r.post(n.events.favorite(e))},async getMyEvents(e={}){return r.get(n.events.myEvents,e)},async getMyFavorites(e={}){return r.get(n.events.myFavorites,e)},async cacheEvents(e){try{const t=e.map(a=>({id:a.id,titulo:a.title,dateTime:new Date(a.startDateTime),local:a.venue?.name||"",bairroId:a.venue?.bairro?.id||"",tags:[],imageUrl:a.coverImage||void 0}));await u.saveMany(t),console.log(`[EventService] Cached ${e.length} events`)}catch(t){console.warn("[EventService] Failed to cache events:",t)}},async cacheEvent(e){try{const t={id:e.id,titulo:e.title,dateTime:new Date(e.startDateTime),local:e.venue?.name||"",bairroId:e.venue?.bairro?.id||"",tags:e.tags?.map(a=>typeof a=="string"?a:a.name||"")||[],imageUrl:e.media?.coverImage||void 0};await u.save(t),console.log(`[EventService] Cached event ${e.id}`)}catch(t){console.warn("[EventService] Failed to cache event:",t)}},async getFromCache(e){try{let t=await u.getAll();if(e.search){const i=e.search.toLowerCase();t=t.filter(d=>d.title?.toLowerCase().includes(i)||d.descriptionShort?.toLowerCase().includes(i))}e.category&&(t=t.filter(i=>i.category?.slug===e.category)),e.bairroId&&(t=t.filter(i=>i.venue?.bairro?.id===e.bairroId)),e.price==="free"?t=t.filter(i=>i.ticket?.type==="free"):e.price==="paid"&&(t=t.filter(i=>i.ticket?.type==="paid")),e.featured&&(t=t.filter(i=>i.isFeatured)),e.orderBy==="popularityScore"?t.sort((i,d)=>d.popularityScore-i.popularityScore):t.sort((i,d)=>new Date(i.startDateTime).getTime()-new Date(d.startDateTime).getTime()),e.order==="desc"&&e.orderBy!=="popularityScore"&&t.reverse();const a=e.page||1,s=e.perPage||15,l=(a-1)*s,g=l+s;return{data:t.slice(l,g),success:!0,meta:{total:t.length,page:a,perPage:s,lastPage:Math.ceil(t.length/s)}}}catch(t){return console.warn("[EventService] Failed to get from cache:",t),{data:[],success:!1,meta:{total:0,page:1,perPage:15,lastPage:1}}}},async refresh(){await u.clear(),await this.getAll()},getDefaultCategories(){return[{id:"1",name:"Show",slug:"show",icon:"music",color:"#9333EA"},{id:"2",name:"Festa",slug:"festa",icon:"party-popper",color:"#F97316"},{id:"3",name:"Cultura",slug:"cultura",icon:"theater",color:"#3B82F6"},{id:"4",name:"Infantil",slug:"infantil",icon:"baby",color:"#10B981"},{id:"5",name:"Gastronômico",slug:"gastronomico",icon:"utensils",color:"#EF4444"},{id:"6",name:"Esportes",slug:"esportes",icon:"trophy",color:"#FBBF24"},{id:"7",name:"Religioso",slug:"religioso",icon:"church",color:"#8B5CF6"},{id:"8",name:"Feira",slug:"feira",icon:"store",color:"#EC4899"},{id:"9",name:"Workshop",slug:"workshop",icon:"graduation-cap",color:"#06B6D4"},{id:"10",name:"Beneficente",slug:"beneficente",icon:"heart",color:"#F43F5E"}]},getDefaultTags(){return[{id:"1",name:"ao ar livre",slug:"ao-ar-livre",color:"#22C55E",isFeatured:!0},{id:"2",name:"família",slug:"familia",color:"#3B82F6",isFeatured:!0},{id:"3",name:"música",slug:"musica",color:"#9333EA",isFeatured:!0},{id:"4",name:"gratuito",slug:"gratuito",color:"#10B981",isFeatured:!0},{id:"5",name:"food truck",slug:"food-truck",color:"#F97316",isFeatured:!1},{id:"6",name:"crianças",slug:"criancas",color:"#EC4899",isFeatured:!0},{id:"7",name:"noturno",slug:"noturno",color:"#6366F1",isFeatured:!1},{id:"8",name:"fim de semana",slug:"fim-de-semana",color:"#EAB308",isFeatured:!0},{id:"9",name:"acessível",slug:"acessivel",color:"#14B8A6",isFeatured:!1},{id:"10",name:"pet friendly",slug:"pet-friendly",color:"#F43F5E",isFeatured:!1}]}},o={all:["events"],lists:()=>[...o.all,"list"],list:e=>[...o.lists(),e],upcoming:e=>[...o.all,"upcoming",e],today:()=>[...o.all,"today"],weekend:()=>[...o.all,"weekend"],featured:e=>[...o.all,"featured",e],search:(e,t)=>[...o.all,"search",e,t],byDate:e=>[...o.all,"date",e],byMonth:(e,t)=>[...o.all,"month",e,t],byCategory:(e,t)=>[...o.all,"category",e,t],byBairro:(e,t)=>[...o.all,"bairro",e,t],byTag:(e,t)=>[...o.all,"tag",e,t],detail:e=>[...o.all,"detail",e],categories:()=>[...o.all,"categories"],tags:()=>[...o.all,"tags"],tagsTrending:()=>[...o.all,"tags","trending"],rsvp:e=>[...o.all,"rsvp",e],attendees:e=>[...o.all,"attendees",e],myEvents:e=>[...o.all,"my-events",e],myFavorites:e=>[...o.all,"my-favorites",e],homeFeatured:()=>[...o.all,"home-featured"],calendarSummary:(e,t)=>[...o.all,"calendar-summary",e,t]},w={events:5*60*1e3,categories:10*60*1e3};function I(e={},t=!0){return v({queryKey:o.list(e),queryFn:()=>h.getAll(e),staleTime:w.events,enabled:t})}function T(){return v({queryKey:o.categories(),queryFn:()=>h.getCategories(),staleTime:w.categories})}export{S as T,T as a,I as u};
