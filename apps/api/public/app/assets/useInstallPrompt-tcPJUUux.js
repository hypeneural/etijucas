import{f as I}from"./index-BxQAMxYM.js";import{r as t}from"./vendor-radix-CQkmBfGK.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=I("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=I("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=I("SquarePlus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),o={DISMISSED_UNTIL:"install_prompt_dismissed_until",NEVER_SHOW:"install_prompt_never",FIRST_VISIT:"install_prompt_first_visit",VISIT_COUNT:"install_prompt_visit_count"},f={INITIAL_SHOW:3e4,REMIND_7_DAYS:7*24*60*60*1e3,REMIND_24_HOURS:24*60*60*1e3};let a=null;typeof window<"u"&&(window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),a=e,console.log("[useInstallPrompt] Global capture: beforeinstallprompt event stored")}),window.addEventListener("appinstalled",()=>{a=null,console.log("[useInstallPrompt] App installed")}));function w(){return typeof window>"u"?!1:window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://")}function M(){if(typeof navigator>"u")return"other";const e=navigator.userAgent;return/Android/i.test(e)?"android":/iPhone|iPad|iPod/.test(e)?"ios":/Windows|Mac|Linux/.test(e)&&!/Mobile/.test(e)?"desktop":"other"}function P(){if(typeof navigator>"u")return!1;const e=navigator.userAgent,s=navigator.vendor,r=/iPhone|iPad|iPod/.test(e),i=s==="Apple Computer, Inc.",c=!/CriOS|FxiOS|OPiOS|EdgiOS/.test(e);return r&&i&&c}function L(){if(typeof localStorage>"u")return!1;if(localStorage.getItem(o.NEVER_SHOW)==="true")return!0;const e=localStorage.getItem(o.DISMISSED_UNTIL);if(e){const s=parseInt(e,10);if(Date.now()<s)return!0;localStorage.removeItem(o.DISMISSED_UNTIL)}return!1}function V(){if(typeof localStorage>"u")return 1;const e=localStorage.getItem(o.VISIT_COUNT)||"0",s=parseInt(e,10)+1;return localStorage.setItem(o.VISIT_COUNT,s.toString()),localStorage.getItem(o.FIRST_VISIT)||localStorage.setItem(o.FIRST_VISIT,Date.now().toString()),s}function W(){const[e,s]=t.useState(a),[r,i]=t.useState(w),[c,d]=t.useState(L),[p,E]=t.useState(!1),[D,m]=t.useState(!1),[g,h]=t.useState(!1),S=t.useMemo(M,[]),u=t.useMemo(P,[]);t.useEffect(()=>{a&&!e&&(console.log("[useInstallPrompt] Found global prompt, syncing to state"),s(a))},[e]),t.useEffect(()=>{V()},[]),t.useEffect(()=>{const n=setTimeout(()=>{E(!0)},f.INITIAL_SHOW);return()=>clearTimeout(n)},[]),t.useEffect(()=>{const n=()=>i(w());n();const l=window.matchMedia("(display-mode: standalone)");return l.addEventListener("change",n),()=>l.removeEventListener("change",n)},[]),t.useEffect(()=>{const n=v=>{v.preventDefault();const _=v;a=_,s(_),console.log("[useInstallPrompt] beforeinstallprompt captured in useEffect")},l=()=>{a=null,s(null),i(!0),localStorage.removeItem(o.DISMISSED_UNTIL),localStorage.removeItem(o.NEVER_SHOW),console.log("[useInstallPrompt] App installed event received")};return window.addEventListener("beforeinstallprompt",n),window.addEventListener("appinstalled",l),()=>{window.removeEventListener("beforeinstallprompt",n),window.removeEventListener("appinstalled",l)}},[]);const y=t.useCallback(async()=>{if(!e)return!1;try{await e.prompt();const{outcome:n}=await e.userChoice;return n==="accepted"?(s(null),!0):!1}catch(n){return console.error("Error showing install prompt:",n),!1}},[e]),T=t.useCallback(n=>{switch(d(!0),h(!1),n){case"later_24h":localStorage.setItem(o.DISMISSED_UNTIL,(Date.now()+f.REMIND_24_HOURS).toString());break;case"later_7d":localStorage.setItem(o.DISMISSED_UNTIL,(Date.now()+f.REMIND_7_DAYS).toString());break;case"never":localStorage.setItem(o.NEVER_SHOW,"true");break}},[]),O=t.useCallback(()=>{m(!0)},[]),k=t.useCallback(()=>{m(!1)},[]),b=t.useCallback(()=>{localStorage.removeItem(o.DISMISSED_UNTIL),localStorage.removeItem(o.NEVER_SHOW),d(!1)},[]),N=t.useCallback(()=>{h(!0),d(!1)},[]);return{shouldShowBanner:t.useMemo(()=>r?!1:g?!0:c||!p||S==="android"&&!e&&!u?!1:u||!!e,[r,c,p,e,u,S,g]),canInstallNative:!!e&&!r,isInstalled:r,isIOSSafari:u&&!r,platform:S,promptInstall:y,dismiss:T,showIOSTutorial:O,hideIOSTutorial:k,isIOSTutorialVisible:D,resetDismissals:b,forceShowBanner:N}}export{C as D,H as S,x as a,W as u};
