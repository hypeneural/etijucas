import{j as e,r as C}from"./vendor-radix-BJ0nhWns.js";import{B as r}from"./button-CPNhRLs3.js";import{C as g}from"./card-DcAzGkRs.js";import{B as w}from"./badge-zsPUXta5.js";import{u as b,R as j,c as N,B as k}from"./index-2hiNaDXu.js";import{a as R}from"./useMyReports-DzKdU6IM.js";import{u as z}from"./useAuthStore-Cd8lVrwm.js";import{L as A}from"./LoginRequired-BtDOrybe.js";import{C as B}from"./CategoryIcon-Df0izeKD.js";import{A as L}from"./arrow-left-DYSEMYmm.js";import{C as T}from"./circle-x-CdTOK3m6.js";import{C as F}from"./circle-check-BTcDIdW4.js";import{C as v}from"./circle-alert-CQgq0B0Q.js";import{C as E}from"./clock-B-qgP-WO.js";import{L as P}from"./loader-circle-Bk0nGNmh.js";import{m as u,A as M}from"./vendor-motion-Clpc6Aj5.js";import{F as D}from"./file-text-DcLCGPB_.js";import{P as S}from"./plus-DLm4vneQ.js";import{F as I}from"./filter-Bw63e5gY.js";import{C as U}from"./chevron-right-DmGxfkeM.js";import{M as $}from"./map-pin-DqsHNiCV.js";import"./vendor-utils-BJCrkUEm.js";import"./vendor-query-B7pQ-O4A.js";import"./report.service-CWvWldVa.js";import"./client-BTgelhMB.js";import"./localDatabase-2Pi5HYDq.js";import"./log-in-DJ2ja0tz.js";const f={recebido:{icon:E,color:"text-blue-600 bg-blue-100",label:"Recebido"},em_analise:{icon:v,color:"text-amber-600 bg-amber-100",label:"Em Análise"},resolvido:{icon:F,color:"text-green-600 bg-green-100",label:"Resolvido"},rejeitado:{icon:T,color:"text-red-600 bg-red-100",label:"Rejeitado"}};function q({report:s}){const m=b(),t=f[s.status]||f.recebido,i=t.icon,d=l=>new Date(l).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"});return e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileTap:{scale:.98},children:e.jsxs(g,{className:"p-4 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>m(`/denuncia/${s.id}`),children:[e.jsxs("div",{className:"flex items-start gap-3",children:[s.media&&s.media.length>0?e.jsx("img",{src:s.media[0].thumbUrl||s.media[0].url,alt:"Foto da denúncia",className:"w-14 h-14 rounded-xl object-cover bg-muted shrink-0",loading:"lazy"}):e.jsx(B,{icon:s.category?.icon||"mdi:dots-horizontal",color:s.category?.color||"#64748b",size:"lg",withBackground:!0,className:"shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:"font-semibold line-clamp-2",children:s.title}),e.jsx(U,{className:"h-5 w-5 text-muted-foreground shrink-0"})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1 mt-0.5",children:s.category?.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs(w,{variant:"secondary",className:N("text-xs",t.color),children:[e.jsx(i,{className:"h-3 w-3 mr-1"}),s.statusLabel||t.label]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:d(s.createdAt)})]}),s.addressText&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3 shrink-0"}),e.jsx("span",{className:"line-clamp-1",children:s.addressText})]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Protocolo"}),e.jsx("code",{className:"text-xs font-mono font-medium",children:s.protocol})]})]})})}function fe(){const s=b(),{isAuthenticated:m}=z();if(!m)return e.jsx(A,{title:"Entrar para ver denúncias",message:"Faça login para ver e acompanhar suas denúncias.",returnUrl:"/minhas-denuncias"});const{reports:t,isLoading:i,error:d,refetch:l}=R(),[o,x]=C.useState(null),h=o?t.filter(a=>a.status===o):t,y=t.reduce((a,n)=>(a[n.status]=(a[n.status]||0)+1,a),{}),c=!!d;return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur-lg border-b safe-top",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>s(-1),className:"rounded-full",children:e.jsx(L,{className:"h-5 w-5"})}),e.jsx("h1",{className:"font-semibold text-lg",children:"Minhas Denúncias"}),e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>l(),className:"rounded-full",children:e.jsx(j,{className:N("h-5 w-5",i&&"animate-spin")})})]})}),e.jsxs("main",{className:"p-4 pb-32",children:[t.length>0&&e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-3 mb-4",children:[e.jsxs(r,{variant:o===null?"default":"outline",size:"sm",onClick:()=>x(null),className:"shrink-0",children:["Todas (",t.length,")"]}),Object.entries(y).map(([a,n])=>{const p=f[a];return p?e.jsxs(r,{variant:o===a?"default":"outline",size:"sm",onClick:()=>x(o===a?null:a),className:"shrink-0",children:[p.label," (",n,")"]},a):null})]}),i&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(P,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Carregando denúncias..."})]}),c&&e.jsxs(g,{className:"p-6 text-center",children:[e.jsx(v,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Erro ao carregar"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Não foi possível carregar suas denúncias."}),e.jsxs(r,{onClick:()=>l(),children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Tentar novamente"]})]}),!i&&!c&&t.length===0&&e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16",children:[e.jsx("div",{className:"p-6 rounded-full bg-muted/50 inline-block mb-6",children:e.jsx(D,{className:"h-12 w-12 text-muted-foreground"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Nenhuma denúncia"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Você ainda não enviou nenhuma denúncia."}),e.jsxs(r,{onClick:()=>s("/report"),children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Fazer primeira denúncia"]})]}),!i&&!c&&h.length>0&&e.jsx("div",{className:"space-y-3",children:e.jsx(M,{children:h.map((a,n)=>e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.05},children:e.jsx(q,{report:a})},a.id))})}),!i&&!c&&t.length>0&&h.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(I,{className:"h-8 w-8 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Nenhuma denúncia com esse status."}),e.jsx(r,{variant:"ghost",onClick:()=>x(null),className:"mt-2",children:"Limpar filtro"})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:e.jsx(k,{activeTab:"reportar",onTabChange:a=>s(`/?tab=${a}`)})})]})]})}export{fe as default};
