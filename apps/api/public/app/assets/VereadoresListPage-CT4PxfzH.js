import{r as o,Z as B,j as e,A as $,_ as P,D,U as C,h as F,m as g,$ as h,a0 as Y,b as _}from"./vendor-app-CFsuVmH9.js";import{u as X,B as w,c as H,Q as q}from"./index-DeilxgjZ.js";import{I as Z}from"./input-ClxaPzc5.js";import{B as m}from"./badge-Dv12eWed.js";import{C as G,a as J}from"./card-DCECeHj3.js";import{T as W,a as ee,b as z}from"./tabs-vWlLg9Oj.js";import{S as E,a as I,b as Q,c as U,d as p}from"./select-BEtsTj19.js";import{A as se,a as ae,b as re}from"./avatar-Bjzmwdxr.js";import{B as te}from"./BottomTabBar-ChZqyQME.js";import{u as le}from"./useAppStore-x428ufYq.js";import{v as ie,a as oe}from"./votes.service--8T0OUeS.js";import"./useCityName-BRW09jaa.js";import"./bairros-Cf5Z_oCw.js";function be(){const a=X(),{activeTab:j,setActiveTab:f}=le(),[v]=o.useState("vereadores"),[r,c]=o.useState(""),[l,N]=o.useState("all"),[i,y]=o.useState("all"),[b,S]=o.useState(!1),{data:n,isLoading:M}=B({queryKey:q.votes.vereadores({partido:l!=="all"?l:void 0,search:r||void 0}),queryFn:()=>ie.getAll({partido:l!=="all"?l:void 0,search:r||void 0}),staleTime:10*60*1e3}),{data:R}=B({queryKey:q.votes.partidos,queryFn:()=>oe.getPartidos(),staleTime:60*60*1e3}),x=M,d=o.useMemo(()=>{if(!n)return[];let s=[...n];if(r){const t=r.toLowerCase();s=s.filter(u=>u.nome.toLowerCase().includes(t))}return i!=="all"&&(s=s.filter(t=>t.cargo===i)),s.sort((t,u)=>{const V={Presidente:1,"Vice-Presidente":2,"1º Secretário":3,"2º Secretário":4,"2º Secretária":4,Vereador:10,Vereadora:10},A=V[t.cargo||"Vereador"]||10,L=V[u.cargo||"Vereador"]||10;return A!==L?A-L:t.nome.localeCompare(u.nome,"pt-BR")}),s},[n,r,i]),K=o.useMemo(()=>{if(!n)return[];const s=new Set(n.map(t=>t.cargo).filter(Boolean));return Array.from(s).sort()},[n]),k=()=>{c(""),N("all"),y("all"),S(!1)},O=s=>{f(s),a("/")},T=r||l!=="all"||i!=="all";return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-muted/50",children:e.jsxs("div",{className:"relative w-full max-w-[420px] h-full bg-background overflow-hidden shadow-elevated",children:[e.jsxs("div",{className:"h-full overflow-y-auto pb-24",children:[e.jsxs("header",{className:"sticky top-0 z-40 bg-background/95 backdrop-blur-xl border-b",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 safe-top",children:[e.jsx(w,{variant:"ghost",size:"icon",onClick:()=>a(-1),children:e.jsx($,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-lg font-bold",children:"Câmara Municipal"}),e.jsx(w,{variant:"ghost",size:"icon",onClick:()=>S(!b),className:H(b&&"bg-primary/10 text-primary"),children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"px-4 pb-3",children:e.jsx(W,{value:v,onValueChange:s=>{s==="votacoes"&&a("/votacoes")},children:e.jsxs(ee,{className:"w-full grid grid-cols-2",children:[e.jsxs(z,{value:"votacoes",className:"gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Votações"]}),e.jsxs(z,{value:"vereadores",className:"gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"Vereadores"]})]})})})]}),e.jsxs("div",{className:"sticky top-28 z-30 bg-background/95 backdrop-blur-xl border-b px-4 py-3 space-y-3",children:[e.jsx(F,{children:b&&e.jsx(g.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Z,{placeholder:"Buscar vereador...",value:r,onChange:s=>c(s.target.value),className:"pl-10 pr-10",autoFocus:!0}),r&&e.jsx("button",{onClick:()=>c(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(h,{className:"h-4 w-4 text-muted-foreground hover:text-foreground"})})]})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs(E,{value:l,onValueChange:N,children:[e.jsx(I,{className:"flex-1 h-9 text-xs",children:e.jsx(Q,{placeholder:"Partido"})}),e.jsxs(U,{children:[e.jsx(p,{value:"all",children:"Todos Partidos"}),R?.map(s=>e.jsx(p,{value:s.sigla,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:s.corHex}}),s.sigla]})},s.id))]})]}),e.jsxs(E,{value:i,onValueChange:y,children:[e.jsx(I,{className:"flex-1 h-9 text-xs",children:e.jsx(Q,{placeholder:"Cargo"})}),e.jsxs(U,{children:[e.jsx(p,{value:"all",children:"Todos Cargos"}),K.map(s=>e.jsx(p,{value:s||"",children:s},s))]})]})]}),T&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l!=="all"&&e.jsxs(m,{variant:"secondary",className:"gap-1 text-xs",children:[l,e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>N("all")})]}),i!=="all"&&e.jsxs(m,{variant:"secondary",className:"gap-1 text-xs",children:[i,e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>y("all")})]}),r&&e.jsxs(m,{variant:"secondary",className:"gap-1 text-xs",children:['"',r,'"',e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>c("")})]}),e.jsx("button",{onClick:k,className:"text-xs text-primary font-medium ml-auto",children:"Limpar tudo"})]})]}),e.jsxs("main",{className:"px-4 py-5",children:[!x&&d.length>0&&e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-between mb-4",children:e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),d.length," ",d.length===1?"vereador":"vereadores"]})}),x&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[e.jsx(_,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando vereadores..."})]}),!x&&d.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 gap-4 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center",children:e.jsx(C,{className:"h-8 w-8 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Nenhum vereador encontrado"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Tente ajustar os filtros de busca"})]}),T&&e.jsx(w,{variant:"outline",size:"sm",onClick:k,children:"Limpar filtros"})]}),!x&&d.length>0&&e.jsx(F,{mode:"popLayout",children:e.jsx(g.div,{layout:!0,className:"grid grid-cols-2 gap-3 pb-8",children:d.map((s,t)=>e.jsx(ce,{vereador:s,index:t,onClick:()=>a(`/vereadores/${s.slug}`)},s.id))})})]})]}),e.jsx(te,{activeTab:j,onTabChange:O})]})})}function ce({vereador:a,index:j,onClick:f}){const v=a.nome.split(" ").map(c=>c[0]).slice(0,2).join("").toUpperCase(),r=["Presidente","Vice-Presidente","1º Secretário","2º Secretário","2º Secretária"].includes(a.cargo||"");return e.jsx(g.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{delay:j*.03},children:e.jsx(G,{className:H("cursor-pointer hover:shadow-lg transition-all duration-200 hover:-translate-y-0.5 overflow-hidden",r&&"ring-2 ring-primary/20"),onClick:f,children:e.jsxs(J,{className:"p-4 flex flex-col items-center text-center gap-3",children:[e.jsxs(se,{className:"w-16 h-16 border-2 border-muted",children:[e.jsx(ae,{src:a.fotoUrl||"",alt:a.nome}),e.jsx(re,{className:"text-lg font-semibold bg-primary/10 text-primary",children:v})]}),e.jsxs("div",{className:"space-y-1.5 w-full",children:[e.jsx("h3",{className:"font-semibold text-sm leading-tight line-clamp-2",children:a.nome}),a.cargo&&a.cargo!=="Vereador"&&a.cargo!=="Vereadora"&&e.jsx(m,{variant:"default",className:"text-[10px] px-2 py-0.5",children:a.cargo}),a.partido&&e.jsx(m,{variant:"secondary",className:"text-xs px-2 py-0.5",style:{backgroundColor:`${a.partido.corHex}20`,borderColor:a.partido.corHex,color:a.partido.corHex},children:a.partido.sigla}),!a.emExercicio&&e.jsx(m,{variant:"outline",className:"text-[10px] px-2 py-0.5 text-muted-foreground",children:"Licenciado"})]})]})})})}export{be as default};
