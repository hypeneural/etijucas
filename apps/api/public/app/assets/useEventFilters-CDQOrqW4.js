import{ad as F,r as s,j as f,ae as L,af as B,ag as D,ah as S}from"./vendor-radix-Dq3xRYQM.js";import{c as b}from"./index-0Qq_GoR_.js";import{C as H}from"./chevron-down-dUKG0Zut.js";import{u as J,a as q}from"./useEventsApi-CA3xy4NW.js";import{o as k,q as K,f as l,r as V,u as W,p as y,v as $,w as G}from"./vendor-utils-DHocNF0y.js";import{p as R}from"./pt-BR-9YxDs27S.js";const le=e=>{const t=l(e,"EEE, dd",{locale:R});return t.charAt(0).toUpperCase()+t.slice(1)},pe=e=>l(e,"dd 'de' MMMM",{locale:R}),ye=e=>l(e,"dd MMM",{locale:R}),E=e=>l(e,"HH:mm"),he=(e,t)=>`${E(e)}â€“${E(t)}`,U=e=>k(e,new Date),Y=e=>k(e,V(new Date,1)),z=e=>K(e),P=e=>l(e,"yyyy-MM-dd"),Q=(e,t=new Date)=>e.filter(a=>a.end>=t).sort((a,c)=>a.start.getTime()-c.start.getTime())[0]??null,X=e=>{const t=e.getHours();return t<12?"morning":t<18?"afternoon":"night"},we=F,Z=s.forwardRef(({className:e,...t},n)=>f.jsx(L,{ref:n,className:b("border-b",e),...t}));Z.displayName="AccordionItem";const ee=s.forwardRef(({className:e,children:t,...n},a)=>f.jsx(B,{className:"flex",children:f.jsxs(D,{ref:a,className:b("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,f.jsx(H,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));ee.displayName=D.displayName;const te=s.forwardRef(({className:e,children:t,...n},a)=>f.jsx(S,{ref:a,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:f.jsx("div",{className:b("pb-4 pt-0",e),children:t})}));te.displayName=S.displayName;const M="etijucas_event_filters",T="etijucas_event_favorites",p={search:"",datePreset:"all",dateRange:{start:null,end:null},categories:[],neighborhoods:[],venues:[],price:"all",priceRange:[0,150],timeOfDay:[],accessibility:!1,parking:!1,kids:!1,outdoor:!1,sortBy:"upcoming"},ae=e=>e.map(t=>({...t,start:y(t.startDateTime),end:y(t.endDateTime)})),re=()=>{if(typeof window>"u")return p;try{const e=window.localStorage.getItem(M);if(!e)return p;const t=JSON.parse(e);return{...p,...t}}catch{return p}},oe=()=>{if(typeof window>"u")return[];try{const e=window.localStorage.getItem(T);return e?JSON.parse(e):[]}catch{return[]}},se=e=>{const t={perPage:100};return e.search&&(t.search=e.search),e.categories.length>0&&(t.category=e.categories[0]),e.neighborhoods.length>0&&(t.bairroId=e.neighborhoods[0]),e.venues.length>0&&(t.venueId=e.venues[0]),e.datePreset==="today"?t.datePreset="today":e.datePreset==="tomorrow"?t.datePreset="tomorrow":e.datePreset==="weekend"?t.datePreset="weekend":e.datePreset==="this_week"?t.datePreset="this_week":e.datePreset==="this_month"?t.datePreset="this_month":e.datePreset==="range"&&e.dateRange.start&&e.dateRange.end&&(t.fromDate=e.dateRange.start,t.toDate=e.dateRange.end),e.price==="free"?t.price="free":e.price==="paid"&&(t.price="paid",e.priceRange[0]>0&&(t.priceMin=e.priceRange[0]),e.priceRange[1]<150&&(t.priceMax=e.priceRange[1])),e.timeOfDay.length>0&&(t.timeOfDay=e.timeOfDay[0]),e.accessibility&&(t.accessibility=!0),e.parking&&(t.parking=!0),e.outdoor&&(t.outdoor=!0),e.kids&&(t.kids=!0),e.sortBy==="popular"?(t.orderBy="popularityScore",t.order="desc"):(t.orderBy="startDateTime",t.order="asc"),t},ne=(e,t)=>{const n=t.search.trim().toLowerCase();return e.filter(a=>{if(n){const c=a.title.toLowerCase().includes(n),d=a.venue?.name?.toLowerCase().includes(n)??!1,g=a.venue?.bairro?.nome?.toLowerCase().includes(n)??!1,h=a.tags.some(m=>(typeof m=="string"?m:m.name).toLowerCase().includes(n));if(!c&&!d&&!g&&!h)return!1}if(t.categories.length>0&&a.category){const c=typeof a.category=="string"?a.category:a.category.slug;if(!t.categories.includes(c))return!1}if(t.neighborhoods.length>0&&a.venue?.bairro&&!t.neighborhoods.includes(a.venue.bairro.nome)&&!t.neighborhoods.includes(a.venue.bairro.id)||t.venues.length>0&&a.venue&&!t.venues.includes(a.venue.name)&&!t.venues.includes(a.venue.id)||t.price==="free"&&a.ticket?.type!=="free"||t.price==="paid"&&a.ticket?.type!=="paid")return!1;if(t.price==="paid"&&a.ticket?.type==="paid"){const[c,d]=t.priceRange,g=a.ticket?.minPrice??0;if(g<c||g>d)return!1}if(t.datePreset==="today"&&!U(a.start)||t.datePreset==="tomorrow"&&!Y(a.start)||t.datePreset==="weekend"&&!z(a.start))return!1;if(t.datePreset==="range"&&t.dateRange.start&&t.dateRange.end){const c={start:$(y(t.dateRange.start)),end:W(y(t.dateRange.end))};if(!G(a.start,c))return!1}if(t.timeOfDay.length>0){const c=X(a.start);if(!t.timeOfDay.includes(c))return!1}return!(t.accessibility&&!a.flags?.accessibility||t.parking&&!a.flags?.parking||t.outdoor&&!a.flags?.outdoor)})},be=()=>{const[e,t]=s.useState(re),[n,a]=s.useState(oe),c=s.useMemo(()=>se(e),[e]),{data:d,isLoading:g,error:h}=J(c),{data:m}=q();s.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(M,JSON.stringify(e))},[e]),s.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(T,JSON.stringify(n))},[n]);const i=s.useMemo(()=>d?.data?ae(d.data):[],[d?.data]),w=s.useMemo(()=>{const o=ne(i,e);return e.sortBy==="popular"?[...o].sort((r,u)=>u.popularityScore-r.popularityScore):[...o].sort((r,u)=>r.start.getTime()-u.start.getTime())},[i,e]),x=s.useMemo(()=>{const o={};return w.forEach(r=>{const u=P(r.start);o[u]||(o[u]=[]),o[u].push(r)}),o},[w]),v=s.useMemo(()=>{const o={};return i.forEach(r=>{const u=P(r.start);o[u]||(o[u]=[]),o[u].push(r)}),o},[i]),N=s.useMemo(()=>{const o=new Set(i.filter(r=>r.venue?.bairro?.nome).map(r=>r.venue.bairro.nome));return Array.from(o).sort()},[i]),O=s.useMemo(()=>{const o=new Set(i.filter(r=>r.venue?.name).map(r=>r.venue.name));return Array.from(o).sort()},[i]),A=s.useMemo(()=>{if(m?.data)return m.data;const o=new Map;return i.forEach(r=>{r.category&&typeof r.category=="object"&&o.set(r.category.slug,r.category)}),Array.from(o.values())},[m?.data,i]),C=s.useCallback(o=>{a(r=>r.includes(o)?r.filter(I=>I!==o):[...r,o])},[]),j=s.useCallback(o=>n.includes(o),[n]),_=s.useMemo(()=>Q(i),[i]);return{meta:s.useMemo(()=>({page:d?.meta?.page??1,perPage:d?.meta?.perPage??100,lastPage:d?.meta?.lastPage??1,total:d?.meta?.total??0}),[d?.meta]),allEvents:i,filteredEvents:w,groupedEvents:x,eventsByDate:v,filters:e,setFilters:t,availableNeighborhoods:N,availableVenues:O,availableCategories:A,favorites:n,toggleFavorite:C,isFavorite:j,nextEvent:_,isLoading:g,error:h}};export{we as A,he as a,Z as b,ee as c,te as d,ne as e,pe as f,z as g,P as h,U as i,le as j,Y as k,ye as l,be as u};
