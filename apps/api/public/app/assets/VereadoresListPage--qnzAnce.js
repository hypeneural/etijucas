import{r as o,aQ as B,j as e,w as D,y as P,aI as Y,a1 as C,l as F,m as g,X as h,aD as $,x as X}from"./vendor-app-D_TKIhWN.js";import{u as _,B as w,c as M,Q as I}from"./index-Bvh4BFmc.js";import{I as G}from"./input-3S3TAj7d.js";import{B as m}from"./badge-CaoVCL1O.js";import{C as J,a as W}from"./card-z87GN8CB.js";import{T as Z,a as ee,b as Q}from"./tabs-6RXx8ZEj.js";import{S as q,a as z,b as E,c as H,d as p}from"./select-DUpwpEpL.js";import{A as ae,a as se,b as re}from"./avatar-BPOVH034.js";import{B as te}from"./BottomTabBar-eQlZQad1.js";import{u as le}from"./useAppStore-BMOdQ1NM.js";import{a as ie,b as oe}from"./votes.service-J3VgtrO_.js";import"./useCityName-DHh1crlW.js";import"./bairros-Cf5Z_oCw.js";function be(){const s=_(),{activeTab:j,setActiveTab:f}=le(),[v]=o.useState("vereadores"),[r,c]=o.useState(""),[l,N]=o.useState("all"),[i,y]=o.useState("all"),[b,S]=o.useState(!1),{data:n,isLoading:R}=B({queryKey:I.votes.vereadores({partido:l!=="all"?l:void 0,search:r||void 0}),queryFn:()=>ie.getAll({partido:l!=="all"?l:void 0,search:r||void 0}),staleTime:10*60*1e3}),{data:U}=B({queryKey:I.votes.partidos,queryFn:()=>oe.getPartidos(),staleTime:60*60*1e3}),x=R,d=o.useMemo(()=>{if(!n)return[];let a=[...n];if(r){const t=r.toLowerCase();a=a.filter(u=>u.nome.toLowerCase().includes(t))}return i!=="all"&&(a=a.filter(t=>t.cargo===i)),a.sort((t,u)=>{const V={Presidente:1,"Vice-Presidente":2,"1º Secretário":3,"2º Secretário":4,"2º Secretária":4,Vereador:10,Vereadora:10},A=V[t.cargo||"Vereador"]||10,L=V[u.cargo||"Vereador"]||10;return A!==L?A-L:t.nome.localeCompare(u.nome,"pt-BR")}),a},[n,r,i]),K=o.useMemo(()=>{if(!n)return[];const a=new Set(n.map(t=>t.cargo).filter(Boolean));return Array.from(a).sort()},[n]),k=()=>{c(""),N("all"),y("all"),S(!1)},O=a=>{f(a),s("/")},T=r||l!=="all"||i!=="all";return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-muted/50",children:e.jsxs("div",{className:"relative w-full max-w-[420px] h-full bg-background overflow-hidden shadow-elevated",children:[e.jsxs("div",{className:"h-full overflow-y-auto pb-24",children:[e.jsxs("header",{className:"sticky top-0 z-40 bg-background/95 backdrop-blur-xl border-b",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 safe-top",children:[e.jsx(w,{variant:"ghost",size:"icon",onClick:()=>s(-1),children:e.jsx(D,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-lg font-bold",children:"Câmara Municipal"}),e.jsx(w,{variant:"ghost",size:"icon",onClick:()=>S(!b),className:M(b&&"bg-primary/10 text-primary"),children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"px-4 pb-3",children:e.jsx(Z,{value:v,onValueChange:a=>{a==="votacoes"&&s("/votacoes")},children:e.jsxs(ee,{className:"w-full grid grid-cols-2",children:[e.jsxs(Q,{value:"votacoes",className:"gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Votações"]}),e.jsxs(Q,{value:"vereadores",className:"gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"Vereadores"]})]})})})]}),e.jsxs("div",{className:"sticky top-28 z-30 bg-background/95 backdrop-blur-xl border-b px-4 py-3 space-y-3",children:[e.jsx(F,{children:b&&e.jsx(g.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(G,{placeholder:"Buscar vereador...",value:r,onChange:a=>c(a.target.value),className:"pl-10 pr-10",autoFocus:!0}),r&&e.jsx("button",{onClick:()=>c(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(h,{className:"h-4 w-4 text-muted-foreground hover:text-foreground"})})]})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsxs(q,{value:l,onValueChange:N,children:[e.jsx(z,{className:"flex-1 h-9 text-xs",children:e.jsx(E,{placeholder:"Partido"})}),e.jsxs(H,{children:[e.jsx(p,{value:"all",children:"Todos Partidos"}),U?.map(a=>e.jsx(p,{value:a.sigla,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:a.corHex}}),a.sigla]})},a.id))]})]}),e.jsxs(q,{value:i,onValueChange:y,children:[e.jsx(z,{className:"flex-1 h-9 text-xs",children:e.jsx(E,{placeholder:"Cargo"})}),e.jsxs(H,{children:[e.jsx(p,{value:"all",children:"Todos Cargos"}),K.map(a=>e.jsx(p,{value:a||"",children:a},a))]})]})]}),T&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l!=="all"&&e.jsxs(m,{variant:"secondary",className:"gap-1 text-xs",children:[l,e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>N("all")})]}),i!=="all"&&e.jsxs(m,{variant:"secondary",className:"gap-1 text-xs",children:[i,e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>y("all")})]}),r&&e.jsxs(m,{variant:"secondary",className:"gap-1 text-xs",children:['"',r,'"',e.jsx(h,{className:"h-3 w-3 cursor-pointer",onClick:()=>c("")})]}),e.jsx("button",{onClick:k,className:"text-xs text-primary font-medium ml-auto",children:"Limpar tudo"})]})]}),e.jsxs("main",{className:"px-4 py-5",children:[!x&&d.length>0&&e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-between mb-4",children:e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),d.length," ",d.length===1?"vereador":"vereadores"]})}),x&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[e.jsx(X,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando vereadores..."})]}),!x&&d.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 gap-4 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center",children:e.jsx(C,{className:"h-8 w-8 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Nenhum vereador encontrado"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Tente ajustar os filtros de busca"})]}),T&&e.jsx(w,{variant:"outline",size:"sm",onClick:k,children:"Limpar filtros"})]}),!x&&d.length>0&&e.jsx(F,{mode:"popLayout",children:e.jsx(g.div,{layout:!0,className:"grid grid-cols-2 gap-3 pb-8",children:d.map((a,t)=>e.jsx(ce,{vereador:a,index:t,onClick:()=>s(`/vereadores/${a.slug}`)},a.id))})})]})]}),e.jsx(te,{activeTab:j,onTabChange:O})]})})}function ce({vereador:s,index:j,onClick:f}){const v=s.nome.split(" ").map(c=>c[0]).slice(0,2).join("").toUpperCase(),r=["Presidente","Vice-Presidente","1º Secretário","2º Secretário","2º Secretária"].includes(s.cargo||"");return e.jsx(g.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{delay:j*.03},children:e.jsx(J,{className:M("cursor-pointer hover:shadow-lg transition-all duration-200 hover:-translate-y-0.5 overflow-hidden",r&&"ring-2 ring-primary/20"),onClick:f,children:e.jsxs(W,{className:"p-4 flex flex-col items-center text-center gap-3",children:[e.jsxs(ae,{className:"w-16 h-16 border-2 border-muted",children:[e.jsx(se,{src:s.fotoUrl||"",alt:s.nome}),e.jsx(re,{className:"text-lg font-semibold bg-primary/10 text-primary",children:v})]}),e.jsxs("div",{className:"space-y-1.5 w-full",children:[e.jsx("h3",{className:"font-semibold text-sm leading-tight line-clamp-2",children:s.nome}),s.cargo&&s.cargo!=="Vereador"&&s.cargo!=="Vereadora"&&e.jsx(m,{variant:"default",className:"text-[10px] px-2 py-0.5",children:s.cargo}),s.partido&&e.jsx(m,{variant:"secondary",className:"text-xs px-2 py-0.5",style:{backgroundColor:`${s.partido.corHex}20`,borderColor:s.partido.corHex,color:s.partido.corHex},children:s.partido.sigla}),!s.emExercicio&&e.jsx(m,{variant:"outline",className:"text-[10px] px-2 py-0.5 text-muted-foreground",children:"Licenciado"})]})]})})})}export{be as default};
