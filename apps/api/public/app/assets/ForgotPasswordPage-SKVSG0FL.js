import{u as K,r as a,j as e,m as c,n as G,w as W,a1 as X,a2 as Y,x as S,K as Z,Z as _,Y as q,l as H}from"./vendor-app-B8taUZN0.js";import{B as u}from"./button-DgFdYI1s.js";import{I as P}from"./input-DZnVLUob.js";import{L as C}from"./label-D9qovYOq.js";import{C as J}from"./card-XIzvIrvz.js";import{P as Q}from"./PhoneInput-D5YQ_81X.js";import{O as U}from"./OTPInput-CnJX2UZk.js";import{c as k}from"./index-Cay7c1rX.js";import"./slider-CaEiSM-4.js";import{v as ee,c as b,a as E}from"./auth.service-2WiSOYkP.js";import{P as se,m as A}from"./auth-utils-B5I9WPFS.js";import"./useHaptics-BLro82Ls.js";import"./client-BdVdTjkU.js";function ue(){const y=K(),[t,o]=a.useState("phone"),[r,R]=a.useState(""),[f,g]=a.useState(""),[O,L]=a.useState(null),[n,D]=a.useState(""),[i,I]=a.useState(""),[l,d]=a.useState(!1),[j,m]=a.useState(null),[x,z]=a.useState(!1),N=ee(b(r)),V=f.length===6,p=se.test(n),h=n===i,v=async(s=!1)=>{if(N){d(!0),m(null);try{const w=await E.forgotPassword({phone:b(r)}),$=new Date(Date.now()+w.expiresIn*1e3);L($),s||o("otp"),s&&g("")}catch(w){m(A(w))}finally{d(!1)}}},F=async()=>{V&&o("password")},B=async()=>{if(!(!p||!h)){d(!0),m(null);try{await E.resetPassword({phone:b(r),code:f,password:n,confirmPassword:i}),o("done")}catch(s){m(A(s))}finally{d(!1)}}},M=async s=>{s.preventDefault(),t==="phone"?await v():t==="otp"?await F():t==="password"&&await B()},T={phone:e.jsxs(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex p-4 rounded-2xl bg-primary/10 mb-4",children:e.jsx(Z,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Recuperar Senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Digite seu telefone para receber um código"})]}),e.jsx(Q,{value:r,onChange:R,error:void 0,autoFocus:!0}),e.jsx(u,{type:"submit",size:"lg",disabled:!N||l,className:"w-full h-14 text-lg font-semibold rounded-2xl",children:l?e.jsx(S,{className:"h-5 w-5 animate-spin"}):e.jsxs(e.Fragment,{children:["Enviar Código",e.jsx(_,{className:"h-5 w-5 ml-2"})]})})]},"phone"),otp:e.jsx(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:e.jsx(U,{value:f,onChange:g,onComplete:s=>{g(s),o("password")},onResend:()=>v(!0),expiresAt:O||void 0,error:j||void 0,isResending:l,isVerifying:!1,phone:`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7)}`})},"otp"),password:e.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex p-4 rounded-2xl bg-primary/10 mb-4",children:e.jsx(W,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Nova Senha"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Digite sua nova senha"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{type:x?"text":"password",value:n,onChange:s=>D(s.target.value),className:k("h-12 text-base pr-10",n.length>0&&!p&&"border-amber-400"),placeholder:"Mínimo 8 caracteres",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>z(!x),className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground",children:x?e.jsx(X,{className:"h-5 w-5"}):e.jsx(Y,{className:"h-5 w-5"})})]}),n.length>0&&!p&&e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:"Mínimo 8 caracteres"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Confirmar Senha"}),e.jsx(P,{type:x?"text":"password",value:i,onChange:s=>I(s.target.value),className:k("h-12 text-base",i.length>0&&!h&&"border-red-400"),placeholder:"Repita a senha",autoComplete:"new-password"}),i.length>0&&!h&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"As senhas não conferem"})]})]}),e.jsx(u,{type:"submit",size:"lg",disabled:!p||!h||l,className:"w-full h-14 text-lg font-semibold rounded-2xl",children:l?e.jsx(S,{className:"h-5 w-5 animate-spin"}):"Redefinir Senha"})]},"password"),done:e.jsxs(c.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex p-6 rounded-full bg-green-100 dark:bg-green-900/30 mb-6",children:e.jsx(G,{className:"h-12 w-12 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Sucesso!"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Sua senha foi redefinida com sucesso."}),e.jsx(u,{size:"lg",onClick:()=>y("/login"),className:"w-full h-14 text-lg font-semibold rounded-2xl bg-green-600 hover:bg-green-700",children:"Fazer Login"})]},"done")};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-primary/5 via-background to-primary/10",children:[e.jsx("div",{className:"p-4",children:t!=="done"&&e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>{t==="phone"?y("/login"):t==="otp"?o("phone"):t==="password"&&o("otp")},className:"rounded-xl",children:e.jsx(q,{className:"h-5 w-5"})})}),e.jsx("div",{className:"flex-1 px-6 flex items-center justify-center pb-20",children:e.jsxs(J,{className:"w-full max-w-md p-6 shadow-xl border-0 bg-background/80 backdrop-blur-xl",children:[e.jsx("form",{onSubmit:M,children:e.jsx(H,{mode:"wait",children:T[t]})}),j&&e.jsx(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-4 p-3 rounded-xl bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 text-center",children:j})})]})})]})}export{ue as default};
