import{r as v,j as e}from"./vendor-radix-CQkmBfGK.js";import{B as c}from"./button-B2-CpamS.js";import{C as O}from"./card-TrzHUMbr.js";import{B as u}from"./badge-BswxyE_a.js";import{f as P,X,d as h,p as _,M as B,u as E,a as $,R as L,b as Q,B as V,m as G}from"./index-BHMDYAkL.js";import{a as J}from"./useMyReports-bmPDXL5X.js";import{u as K,L as W}from"./LoginRequired-Dfmepq4R.js";import{C as F}from"./CategoryIcon-Bn5pu-4a.js";import{I as D}from"./input-27FI8huz.js";import{A as R,m as N}from"./vendor-motion-3m9Rluu3.js";import{F as T}from"./filter-1dKpfO1p.js";import{T as I}from"./tag-CeiT_4It.js";import{C as Y}from"./chevron-down-D_4YcjCI.js";import{S}from"./search-738_hg3k.js";import{F as M}from"./file-text-BS0jQVQm.js";import{A as Z}from"./arrow-left-BrfYu7ne.js";import{S as ee}from"./sliders-horizontal-BiTITWPF.js";import{C as q}from"./circle-alert-ClHputSO.js";import{P as se}from"./plus-CO6s2X6u.js";import{C as ae}from"./circle-x-COcvXSaB.js";import{C as te}from"./circle-check-Cg5avc8M.js";import{C as le}from"./clock-B3f3gsdz.js";import"./vendor-utils-YRYEdvK0.js";import"./vendor-query-BnSlUk-m.js";import"./report.service-187nWd9B.js";import"./log-in-CMLE9dJA.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=P("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=P("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),oe=[{value:"all",label:"Todos",color:"bg-gray-100 text-gray-700"},{value:"recebido",label:"Recebido",color:"bg-blue-100 text-blue-700"},{value:"em_analise",label:"Em Análise",color:"bg-amber-100 text-amber-700"},{value:"resolvido",label:"Resolvido",color:"bg-green-100 text-green-700"},{value:"rejeitado",label:"Rejeitado",color:"bg-red-100 text-red-700"}],ne=[{value:"all",label:"Qualquer período"},{value:"7d",label:"Últimos 7 dias"},{value:"30d",label:"Últimos 30 dias"},{value:"90d",label:"Últimos 3 meses"},{value:"365d",label:"Último ano"},{value:"custom",label:"Personalizado"}];function ce({isOpen:t,onClose:p,filters:o,onApplyFilters:d,showMyReportsOnly:w=!1}){const{categories:g}=K(),[i,n]=v.useState(o),[a,y]=v.useState("all"),[m,f]=v.useState(!1);v.useEffect(()=>{n(o)},[o]);const j=s=>{n(l=>({...l,status:s}))},r=s=>{n(l=>({...l,categoryId:s})),f(!1)},x=s=>{y(s);const l=new Date;let b;switch(s){case"7d":b=new Date(l.setDate(l.getDate()-7)).toISOString().split("T")[0];break;case"30d":b=new Date(l.setDate(l.getDate()-30)).toISOString().split("T")[0];break;case"90d":b=new Date(l.setDate(l.getDate()-90)).toISOString().split("T")[0];break;case"365d":b=new Date(l.setDate(l.getDate()-365)).toISOString().split("T")[0];break;default:b=void 0}n(U=>({...U,startDate:b,endDate:s==="all"?void 0:new Date().toISOString().split("T")[0]}))},k=()=>{d(i),p()},H=()=>{n({status:"all",categoryId:void 0,startDate:void 0,endDate:void 0,protocol:void 0,address:void 0,title:void 0}),y("all")},z=Object.entries(i).filter(([s,l])=>l&&l!=="all"&&s!=="status").length+(i.status&&i.status!=="all"?1:0),C=g.find(s=>s.id===i.categoryId);return e.jsx(R,{children:t&&e.jsxs(e.Fragment,{children:[e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50",onClick:p}),e.jsxs(N.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-3xl max-h-[85vh] overflow-hidden",children:[e.jsx("div",{className:"flex justify-center pt-3 pb-2",children:e.jsx("div",{className:"w-10 h-1 rounded-full bg-muted-foreground/30"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Filtros Avançados"}),z>0&&e.jsx(u,{variant:"secondary",className:"ml-2",children:z})]}),e.jsx(c,{variant:"ghost",size:"icon",onClick:p,className:"rounded-full",children:e.jsx(X,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"overflow-y-auto max-h-[calc(85vh-180px)] px-4 py-4 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(I,{className:"h-4 w-4 text-muted-foreground"}),"Situação"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:oe.map(s=>e.jsx("button",{onClick:()=>j(s.value),className:h("px-3 py-1.5 rounded-full text-sm font-medium transition-all",i.status===s.value?s.color+" ring-2 ring-offset-2 ring-primary":"bg-muted hover:bg-muted/80"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(I,{className:"h-4 w-4 text-muted-foreground"}),"Categoria"]}),e.jsxs("button",{onClick:()=>f(!m),className:h("w-full flex items-center justify-between p-3 rounded-xl border transition-all",m?"border-primary bg-primary/5":"border-border"),children:[e.jsx("div",{className:"flex items-center gap-3",children:C?e.jsxs(e.Fragment,{children:[e.jsx(F,{icon:C.icon,color:C.color,size:"sm"}),e.jsx("span",{className:"font-medium",children:C.name})]}):e.jsx("span",{className:"text-muted-foreground",children:"Todas as categorias"})}),e.jsx(Y,{className:h("h-5 w-5 text-muted-foreground transition-transform",m&&"rotate-180")})]}),e.jsx(R,{children:m&&e.jsx(N.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[e.jsx("button",{onClick:()=>r(void 0),className:h("p-3 rounded-xl border text-left transition-all",i.categoryId?"border-border hover:border-primary/50":"border-primary bg-primary/5"),children:e.jsx("span",{className:"text-sm font-medium",children:"Todas"})}),g.map(s=>e.jsxs("button",{onClick:()=>r(s.id),className:h("p-3 rounded-xl border text-left transition-all flex items-center gap-2",i.categoryId===s.id?"border-primary bg-primary/5":"border-border hover:border-primary/50"),children:[e.jsx(F,{icon:s.icon,color:s.color,size:"sm"}),e.jsx("span",{className:"text-sm font-medium line-clamp-1",children:s.name})]},s.id))]})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(_,{className:"h-4 w-4 text-muted-foreground"}),"Período"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ne.filter(s=>s.value!=="custom").map(s=>e.jsx("button",{onClick:()=>x(s.value),className:h("px-3 py-1.5 rounded-full text-sm font-medium transition-all",a===s.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:s.label},s.value))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground"}),"Protocolo"]}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Buscar por protocolo...",value:i.protocol||"",onChange:s=>n(l=>({...l,protocol:s.target.value||void 0})),className:"pl-10 rounded-xl"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(M,{className:"h-4 w-4 text-muted-foreground"}),"Título"]}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Buscar por título...",value:i.title||"",onChange:s=>n(l=>({...l,title:s.target.value||void 0})),className:"pl-10 rounded-xl"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(B,{className:"h-4 w-4 text-muted-foreground"}),"Endereço"]}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Buscar por endereço...",value:i.address||"",onChange:s=>n(l=>({...l,address:s.target.value||void 0})),className:"pl-10 rounded-xl"})]})]})]})]}),e.jsxs("div",{className:"border-t p-4 flex gap-3 safe-bottom",children:[e.jsxs(c,{variant:"outline",size:"lg",className:"flex-1 h-12 rounded-2xl",onClick:H,children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Limpar"]}),e.jsxs(c,{size:"lg",className:"flex-[2] h-12 rounded-2xl",onClick:k,children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Aplicar Filtros"]})]})]})]})})}const A={recebido:{icon:le,color:"text-blue-600 bg-blue-100",label:"Recebido"},em_analise:{icon:q,color:"text-amber-600 bg-amber-100",label:"Em Análise"},resolvido:{icon:te,color:"text-green-600 bg-green-100",label:"Resolvido"},rejeitado:{icon:ae,color:"text-red-600 bg-red-100",label:"Rejeitado"}};function de({report:t}){const p=E(),o=A[t.status]||A.recebido,d=o.icon,w=g=>new Date(g).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"});return e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileTap:{scale:.98},children:e.jsxs(O,{className:"p-4 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>p(`/denuncia/${t.id}`),children:[e.jsxs("div",{className:"flex items-start gap-3",children:[t.media&&t.media.length>0?e.jsx("img",{src:t.media[0].thumbUrl||t.media[0].url,alt:"Foto da denúncia",className:"w-14 h-14 rounded-xl object-cover bg-muted shrink-0",loading:"lazy"}):e.jsx(F,{icon:t.category?.icon||"mdi:dots-horizontal",color:t.category?.color||"#64748b",size:"lg",withBackground:!0,className:"shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:"font-semibold line-clamp-2",children:t.title}),e.jsx(G,{className:"h-5 w-5 text-muted-foreground shrink-0"})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1 mt-0.5",children:t.category?.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs(u,{variant:"secondary",className:h("text-xs",o.color),children:[e.jsx(d,{className:"h-3 w-3 mr-1"}),t.statusLabel||o.label]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:w(t.createdAt)})]}),t.addressText&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 flex items-center gap-1",children:[e.jsx(B,{className:"h-3 w-3 shrink-0"}),e.jsx("span",{className:"line-clamp-1",children:t.addressText})]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Protocolo"}),e.jsx("code",{className:"text-xs font-mono font-medium",children:t.protocol})]})]})})}function Be(){const t=E(),{isAuthenticated:p}=$();if(!p)return e.jsx(W,{title:"Entrar para ver denúncias",message:"Faça login para ver e acompanhar suas denúncias.",returnUrl:"/minhas-denuncias"});const{reports:o,isLoading:d,error:w,refetch:g}=J(),[i,n]=v.useState(!1),[a,y]=v.useState({status:"all"}),m=o.filter(r=>{if(a.status&&a.status!=="all"&&r.status!==a.status||a.categoryId&&r.category?.id!==a.categoryId||a.protocol&&!r.protocol?.toLowerCase().includes(a.protocol.toLowerCase())||a.title&&!r.title?.toLowerCase().includes(a.title.toLowerCase())||a.address&&!r.addressText?.toLowerCase().includes(a.address.toLowerCase()))return!1;if(a.startDate){const x=new Date(r.createdAt),k=new Date(a.startDate);if(x<k)return!1}return!0}),f=Object.entries(a).filter(([r,x])=>x&&x!=="all").length,j=!!w;return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur-lg border-b safe-top",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>t(-1),className:"rounded-full",children:e.jsx(Z,{className:"h-5 w-5"})}),e.jsx("h1",{className:"font-semibold text-lg",children:"Minhas Denúncias"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(c,{variant:"ghost",size:"icon",onClick:()=>n(!0),className:"rounded-full relative",children:[e.jsx(ee,{className:"h-5 w-5"}),f>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-primary text-primary-foreground text-xs w-5 h-5 rounded-full flex items-center justify-center",children:f})]}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>g(),className:"rounded-full",children:e.jsx(L,{className:h("h-5 w-5",d&&"animate-spin")})})]})]})}),e.jsxs("main",{className:"p-4 pb-32",children:[f>0&&e.jsxs("div",{className:"flex gap-2 flex-wrap mb-4",children:[a.status&&a.status!=="all"&&e.jsxs(u,{variant:"secondary",className:"gap-1",children:["Status: ",a.status]}),a.categoryId&&e.jsx(u,{variant:"secondary",className:"gap-1",children:"Categoria filtrada"}),a.protocol&&e.jsxs(u,{variant:"secondary",className:"gap-1",children:["Protocolo: ",a.protocol]}),a.title&&e.jsxs(u,{variant:"secondary",className:"gap-1",children:["Título: ",a.title]}),a.address&&e.jsxs(u,{variant:"secondary",className:"gap-1",children:["Endereço: ",a.address]}),a.startDate&&e.jsx(u,{variant:"secondary",className:"gap-1",children:"Período filtrado"}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>y({status:"all"}),className:"h-6 px-2 text-xs",children:"Limpar"})]}),d&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(Q,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Carregando denúncias..."})]}),j&&e.jsxs(O,{className:"p-6 text-center",children:[e.jsx(q,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Erro ao carregar"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Não foi possível carregar suas denúncias."}),e.jsxs(c,{onClick:()=>g(),children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Tentar novamente"]})]}),!d&&!j&&o.length===0&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16",children:[e.jsx("div",{className:"p-6 rounded-full bg-muted/50 inline-block mb-6",children:e.jsx(M,{className:"h-12 w-12 text-muted-foreground"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Nenhuma denúncia"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Você ainda não enviou nenhuma denúncia."}),e.jsxs(c,{onClick:()=>t("/report"),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Fazer primeira denúncia"]})]}),!d&&!j&&m.length>0&&e.jsx("div",{className:"space-y-3",children:e.jsx(R,{children:m.map((r,x)=>e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:x*.05},children:e.jsx(de,{report:r})},r.id))})}),!d&&!j&&o.length>0&&m.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(T,{className:"h-8 w-8 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Nenhuma denúncia com esse status."}),e.jsx(c,{variant:"ghost",onClick:()=>setFilter(null),className:"mt-2",children:"Limpar filtro"})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:e.jsx(V,{activeTab:"reportar",onTabChange:r=>t(`/?tab=${r}`)})})]}),e.jsx(ce,{isOpen:i,onClose:()=>n(!1),filters:a,onApplyFilters:y,showMyReportsOnly:!0})]})}export{Be as default};
